<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Random Number Generation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Random Number Generation</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabba5d860116b4ede7acf4338b1296081"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#gabba5d860116b4ede7acf4338b1296081">wc_InitNetRandom</a> (const char *, wnr_hmac_key, int)</td></tr>
<tr class="memdesc:gabba5d860116b4ede7acf4338b1296081"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init global Whitewood netRandom context.  <a href="#gabba5d860116b4ede7acf4338b1296081">More...</a><br /></td></tr>
<tr class="separator:gabba5d860116b4ede7acf4338b1296081"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadbf88b63fbfabfa5d23225e5bfb6d7b9"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#gadbf88b63fbfabfa5d23225e5bfb6d7b9">wc_FreeNetRandom</a> (void)</td></tr>
<tr class="memdesc:gadbf88b63fbfabfa5d23225e5bfb6d7b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free global Whitewood netRandom context.  <a href="#gadbf88b63fbfabfa5d23225e5bfb6d7b9">More...</a><br /></td></tr>
<tr class="separator:gadbf88b63fbfabfa5d23225e5bfb6d7b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaebcb2bd505879f9080396a04ad990898"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898">wc_InitRng</a> (<a class="el" href="structWC__RNG.html">WC_RNG</a> *)</td></tr>
<tr class="memdesc:gaebcb2bd505879f9080396a04ad990898"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the seed (from OS) and key cipher for rng. rng-&gt;drbg (deterministic random bit generator) allocated (should be deallocated with wc_FreeRng). This is a blocking operation.  <a href="#gaebcb2bd505879f9080396a04ad990898">More...</a><br /></td></tr>
<tr class="separator:gaebcb2bd505879f9080396a04ad990898"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae8a5ea6b9d650df7a7c6d123dff5a60"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#gaae8a5ea6b9d650df7a7c6d123dff5a60">wc_RNG_GenerateBlock</a> (<a class="el" href="structWC__RNG.html">WC_RNG</a> *, byte *, word32 sz)</td></tr>
<tr class="memdesc:gaae8a5ea6b9d650df7a7c6d123dff5a60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies a sz bytes of pseudorandom data to output. Will reseed rng if needed (blocking).  <a href="#gaae8a5ea6b9d650df7a7c6d123dff5a60">More...</a><br /></td></tr>
<tr class="separator:gaae8a5ea6b9d650df7a7c6d123dff5a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5fa23cf19474f6bbea283bd13f0e9c1d"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#ga5fa23cf19474f6bbea283bd13f0e9c1d">wc_RNG_GenerateByte</a> (<a class="el" href="structWC__RNG.html">WC_RNG</a> *, byte *)</td></tr>
<tr class="memdesc:ga5fa23cf19474f6bbea283bd13f0e9c1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls wc_RNG_GenerateBlock to copy a byte of pseudorandom data to b. Will reseed rng if needed.  <a href="#ga5fa23cf19474f6bbea283bd13f0e9c1d">More...</a><br /></td></tr>
<tr class="separator:ga5fa23cf19474f6bbea283bd13f0e9c1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf2a36e64da21dcbf8d190d5d4c31e7c7"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#gaf2a36e64da21dcbf8d190d5d4c31e7c7">wc_FreeRng</a> (<a class="el" href="structWC__RNG.html">WC_RNG</a> *)</td></tr>
<tr class="memdesc:gaf2a36e64da21dcbf8d190d5d4c31e7c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Should be called when RNG no longer needed in order to securely free drgb. Zeros and XFREEs rng-drbg.  <a href="#gaf2a36e64da21dcbf8d190d5d4c31e7c7">More...</a><br /></td></tr>
<tr class="separator:gaf2a36e64da21dcbf8d190d5d4c31e7c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga76884bf6c96f57c7e97fadc24472b924"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924">wc_RNG_HealthTest</a> (int reseed, const byte *entropyA, word32 entropyASz, const byte *entropyB, word32 entropyBSz, byte *output, word32 outputSz)</td></tr>
<tr class="memdesc:ga76884bf6c96f57c7e97fadc24472b924"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates and tests functionality of drbg.  <a href="#ga76884bf6c96f57c7e97fadc24472b924">More...</a><br /></td></tr>
<tr class="separator:ga76884bf6c96f57c7e97fadc24472b924"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="gadbf88b63fbfabfa5d23225e5bfb6d7b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadbf88b63fbfabfa5d23225e5bfb6d7b9">&#9670;&nbsp;</a></span>wc_FreeNetRandom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_FreeNetRandom </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free global Whitewood netRandom context. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_MUTEX_E Error locking mutex on wnr_mutex</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">none</td><td>No returns.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__Random.html#gadbf88b63fbfabfa5d23225e5bfb6d7b9">wc_FreeNetRandom</a>();</div><div class="line"><span class="keywordflow">if</span>(ret != 0)</div><div class="line">{</div><div class="line">    <span class="comment">// Handle the error</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__Random.html#gabba5d860116b4ede7acf4338b1296081" title="Init global Whitewood netRandom context. ">wc_InitNetRandom</a> </dd></dl>

</div>
</div>
<a id="gaf2a36e64da21dcbf8d190d5d4c31e7c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf2a36e64da21dcbf8d190d5d4c31e7c7">&#9670;&nbsp;</a></span>wc_FreeRng()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_FreeRng </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structWC__RNG.html">WC_RNG</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Should be called when RNG no longer needed in order to securely free drgb. Zeros and XFREEs rng-drbg. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
BAD_FUNC_ARG rng or rng-&gt;drgb null </dd>
<dd>
RNG_FAILURE_E Failed to deallocated drbg</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rng</td><td>random number generator initialized with wc_InitRng</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">RNG  rng;</div><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898">wc_InitRng</a>(&amp;rng);</div><div class="line"><span class="keywordflow">if</span> (ret != 0) {</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//init of rng failed!</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__Random.html#gaf2a36e64da21dcbf8d190d5d4c31e7c7">wc_FreeRng</a>(&amp;rng);</div><div class="line"><span class="keywordflow">if</span> (ret != 0) { </div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//free of rng failed!</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_InitRngCavium </dd>
<dd>
<a class="el" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898" title="Gets the seed (from OS) and key cipher for rng. rng-&gt;drbg (deterministic random bit generator) alloca...">wc_InitRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaae8a5ea6b9d650df7a7c6d123dff5a60" title="Copies a sz bytes of pseudorandom data to output. Will reseed rng if needed (blocking). ">wc_RNG_GenerateBlock</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga5fa23cf19474f6bbea283bd13f0e9c1d" title="Calls wc_RNG_GenerateBlock to copy a byte of pseudorandom data to b. Will reseed rng if needed...">wc_RNG_GenerateByte</a>, </dd>
<dd>
<a class="el" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924" title="Creates and tests functionality of drbg. ">wc_RNG_HealthTest</a> </dd></dl>

</div>
</div>
<a id="gabba5d860116b4ede7acf4338b1296081"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabba5d860116b4ede7acf4338b1296081">&#9670;&nbsp;</a></span>wc_InitNetRandom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_InitNetRandom </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">wnr_hmac_key&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init global Whitewood netRandom context. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Either configFile is null or timeout is negative. </dd>
<dd>
RNG_FAILURE_E There was a failure initializing the rng.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configFile</td><td>Path to configuration file </td></tr>
    <tr><td class="paramname">hmac_cb</td><td>Optional to create HMAC callback. </td></tr>
    <tr><td class="paramname">timeout</td><td>A timeout duration.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">char</span>* config = <span class="stringliteral">&quot;path/to/config/example.conf&quot;</span>;</div><div class="line"><span class="keywordtype">int</span> time = <span class="comment">// Some sufficient timeout value;</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__Random.html#gabba5d860116b4ede7acf4338b1296081">wc_InitNetRandom</a>(config, NULL, time) != 0)</div><div class="line">{</div><div class="line">    <span class="comment">// Some error occured</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__Random.html#gadbf88b63fbfabfa5d23225e5bfb6d7b9" title="Free global Whitewood netRandom context. ">wc_FreeNetRandom</a> </dd></dl>

</div>
</div>
<a id="gaebcb2bd505879f9080396a04ad990898"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaebcb2bd505879f9080396a04ad990898">&#9670;&nbsp;</a></span>wc_InitRng()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_InitRng </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structWC__RNG.html">WC_RNG</a> *&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the seed (from OS) and key cipher for rng. rng-&gt;drbg (deterministic random bit generator) allocated (should be deallocated with wc_FreeRng). This is a blocking operation. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
MEMORY_E XMALLOC failed </dd>
<dd>
WINCRYPT_E wc_GenerateSeed: failed to acquire context </dd>
<dd>
CRYPTGEN_E wc_GenerateSeed: failed to get random </dd>
<dd>
BAD_FUNC_ARG wc_RNG_GenerateBlock input is null or sz exceeds MAX_REQUEST_LEN </dd>
<dd>
DRBG_CONT_FIPS_E wc_RNG_GenerateBlock: Hash_gen returned DRBG_CONT_FAILURE </dd>
<dd>
RNG_FAILURE_E wc_RNG_GenerateBlock: Default error. rng’s status originally not ok, or set to DRBG_FAILED</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rng</td><td>random number generator to be initialized for use with a seed and key cipher</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">RNG  rng;</div><div class="line"><span class="keywordtype">int</span> ret;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef HAVE_CAVIUM</span></div><div class="line">ret = wc_InitRngCavium(&amp;rng, CAVIUM_DEV_ID);</div><div class="line"><span class="keywordflow">if</span> (ret != 0){       </div><div class="line">    printf(“RNG Nitrox init <span class="keywordflow">for</span> device: %d failed”, CAVIUM_DEV_ID);</div><div class="line">    <span class="keywordflow">return</span> -1;</div><div class="line">}</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line">ret = <a class="code" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898">wc_InitRng</a>(&amp;rng);</div><div class="line"><span class="keywordflow">if</span> (ret != 0){</div><div class="line">    printf(“RNG init failed”);</div><div class="line">    <span class="keywordflow">return</span> -1;</div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_InitRngCavium </dd>
<dd>
<a class="el" href="group__Random.html#gaae8a5ea6b9d650df7a7c6d123dff5a60" title="Copies a sz bytes of pseudorandom data to output. Will reseed rng if needed (blocking). ">wc_RNG_GenerateBlock</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga5fa23cf19474f6bbea283bd13f0e9c1d" title="Calls wc_RNG_GenerateBlock to copy a byte of pseudorandom data to b. Will reseed rng if needed...">wc_RNG_GenerateByte</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaf2a36e64da21dcbf8d190d5d4c31e7c7" title="Should be called when RNG no longer needed in order to securely free drgb. Zeros and XFREEs rng-drbg...">wc_FreeRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924" title="Creates and tests functionality of drbg. ">wc_RNG_HealthTest</a> </dd></dl>

</div>
</div>
<a id="gaae8a5ea6b9d650df7a7c6d123dff5a60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae8a5ea6b9d650df7a7c6d123dff5a60">&#9670;&nbsp;</a></span>wc_RNG_GenerateBlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_RNG_GenerateBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structWC__RNG.html">WC_RNG</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies a sz bytes of pseudorandom data to output. Will reseed rng if needed (blocking). </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
BAD_FUNC_ARG an input is null or sz exceeds MAX_REQUEST_LEN </dd>
<dd>
DRBG_CONT_FIPS_E Hash_gen returned DRBG_CONT_FAILURE </dd>
<dd>
RNG_FAILURE_E Default error. rng’s status originally not ok, or set to DRBG_FAILED</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rng</td><td>random number generator initialized with wc_InitRng </td></tr>
    <tr><td class="paramname">output</td><td>buffer to which the block is copied </td></tr>
    <tr><td class="paramname">sz</td><td>size of output in bytes</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">RNG  rng;</div><div class="line"><span class="keywordtype">int</span>  sz = 32;</div><div class="line">byte block[sz];</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898">wc_InitRng</a>(&amp;rng);</div><div class="line"><span class="keywordflow">if</span> (ret != 0) {</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//init of rng failed!</span></div><div class="line">}</div><div class="line"></div><div class="line">ret = <a class="code" href="group__Random.html#gaae8a5ea6b9d650df7a7c6d123dff5a60">wc_RNG_GenerateBlock</a>(&amp;rng, block, sz);</div><div class="line"><span class="keywordflow">if</span> (ret != 0) {</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//generating block failed!</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_InitRngCavium, <a class="el" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898" title="Gets the seed (from OS) and key cipher for rng. rng-&gt;drbg (deterministic random bit generator) alloca...">wc_InitRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga5fa23cf19474f6bbea283bd13f0e9c1d" title="Calls wc_RNG_GenerateBlock to copy a byte of pseudorandom data to b. Will reseed rng if needed...">wc_RNG_GenerateByte</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaf2a36e64da21dcbf8d190d5d4c31e7c7" title="Should be called when RNG no longer needed in order to securely free drgb. Zeros and XFREEs rng-drbg...">wc_FreeRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924" title="Creates and tests functionality of drbg. ">wc_RNG_HealthTest</a> </dd></dl>

</div>
</div>
<a id="ga5fa23cf19474f6bbea283bd13f0e9c1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5fa23cf19474f6bbea283bd13f0e9c1d">&#9670;&nbsp;</a></span>wc_RNG_GenerateByte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_RNG_GenerateByte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structWC__RNG.html">WC_RNG</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls wc_RNG_GenerateBlock to copy a byte of pseudorandom data to b. Will reseed rng if needed. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
BAD_FUNC_ARG an input is null or sz exceeds MAX_REQUEST_LEN </dd>
<dd>
DRBG_CONT_FIPS_E Hash_gen returned DRBG_CONT_FAILURE </dd>
<dd>
RNG_FAILURE_E Default error. rng’s status originally not ok, or set to DRBG_FAILED</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rng</td><td>random number generator initialized with wc_InitRng </td></tr>
    <tr><td class="paramname">b</td><td>one byte buffer to which the block is copied</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">RNG  rng;</div><div class="line"><span class="keywordtype">int</span>  sz = 32;</div><div class="line">byte b[1];</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> ret = <a class="code" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898">wc_InitRng</a>(&amp;rng);</div><div class="line"><span class="keywordflow">if</span> (ret != 0) {</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//init of rng failed!</span></div><div class="line">}</div><div class="line"></div><div class="line">ret = <a class="code" href="group__Random.html#ga5fa23cf19474f6bbea283bd13f0e9c1d">wc_RNG_GenerateByte</a>(&amp;rng, b);</div><div class="line"><span class="keywordflow">if</span> (ret != 0) {</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//generating block failed!</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_InitRngCavium </dd>
<dd>
<a class="el" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898" title="Gets the seed (from OS) and key cipher for rng. rng-&gt;drbg (deterministic random bit generator) alloca...">wc_InitRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaae8a5ea6b9d650df7a7c6d123dff5a60" title="Copies a sz bytes of pseudorandom data to output. Will reseed rng if needed (blocking). ">wc_RNG_GenerateBlock</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaf2a36e64da21dcbf8d190d5d4c31e7c7" title="Should be called when RNG no longer needed in order to securely free drgb. Zeros and XFREEs rng-drbg...">wc_FreeRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924" title="Creates and tests functionality of drbg. ">wc_RNG_HealthTest</a> </dd></dl>

</div>
</div>
<a id="ga76884bf6c96f57c7e97fadc24472b924"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga76884bf6c96f57c7e97fadc24472b924">&#9670;&nbsp;</a></span>wc_RNG_HealthTest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_RNG_HealthTest </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reseed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>entropyA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>entropyASz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>entropyB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>entropyBSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>outputSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates and tests functionality of drbg. </p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd>
<dd>
BAD_FUNC_ARG entropyA and output must not be null. If reseed set entropyB must not be null </dd>
<dd>
-1 test failed</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">int</td><td>reseed: if set, will test reseed functionality </td></tr>
    <tr><td class="paramname">entropyA</td><td>entropy to instantiate drgb with </td></tr>
    <tr><td class="paramname">entropyASz</td><td>size of entropyA in bytes </td></tr>
    <tr><td class="paramname">entropyB</td><td>If reseed set, drbg will be reseeded with entropyB </td></tr>
    <tr><td class="paramname">entropyBSz</td><td>size of entropyB in bytes </td></tr>
    <tr><td class="paramname">output</td><td>initialized to random data seeded with entropyB if seedrandom is set, and entropyA otherwise </td></tr>
    <tr><td class="paramname">outputSz</td><td>length of output in bytes</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line">byte output[SHA256_DIGEST_SIZE * 4];</div><div class="line"><span class="keyword">const</span> byte test1EntropyB[] = ....; <span class="comment">// test input for reseed false</span></div><div class="line"><span class="keyword">const</span> byte test1Output[] = ....;   <span class="comment">// testvector: expected output of</span></div><div class="line">                               <span class="comment">// reseed false</span></div><div class="line">ret = <a class="code" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924">wc_RNG_HealthTest</a>(0, test1Entropy, <span class="keyword">sizeof</span>(test1Entropy), NULL, 0,</div><div class="line">                    output, <span class="keyword">sizeof</span>(output));</div><div class="line"><span class="keywordflow">if</span> (ret != 0)</div><div class="line">    <span class="keywordflow">return</span> -1;<span class="comment">//healthtest without reseed failed</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (XMEMCMP(test1Output, output, <span class="keyword">sizeof</span>(output)) != 0)</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//compare to testvector failed: unexpected output</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> byte test2EntropyB[] = ....; <span class="comment">// test input for reseed</span></div><div class="line"><span class="keyword">const</span> byte test2Output[] = ....;   <span class="comment">// testvector expected output of reseed</span></div><div class="line">ret = <a class="code" href="group__Random.html#ga76884bf6c96f57c7e97fadc24472b924">wc_RNG_HealthTest</a>(1, test2EntropyA, <span class="keyword">sizeof</span>(test2EntropyA),</div><div class="line">                    test2EntropyB, <span class="keyword">sizeof</span>(test2EntropyB),</div><div class="line">                    output, <span class="keyword">sizeof</span>(output));</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (XMEMCMP(test2Output, output, <span class="keyword">sizeof</span>(output)) != 0)</div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">//compare to testvector failed</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_InitRngCavium </dd>
<dd>
<a class="el" href="group__Random.html#gaebcb2bd505879f9080396a04ad990898" title="Gets the seed (from OS) and key cipher for rng. rng-&gt;drbg (deterministic random bit generator) alloca...">wc_InitRng</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaae8a5ea6b9d650df7a7c6d123dff5a60" title="Copies a sz bytes of pseudorandom data to output. Will reseed rng if needed (blocking). ">wc_RNG_GenerateBlock</a> </dd>
<dd>
<a class="el" href="group__Random.html#ga5fa23cf19474f6bbea283bd13f0e9c1d" title="Calls wc_RNG_GenerateBlock to copy a byte of pseudorandom data to b. Will reseed rng if needed...">wc_RNG_GenerateByte</a> </dd>
<dd>
<a class="el" href="group__Random.html#gaf2a36e64da21dcbf8d190d5d4c31e7c7" title="Should be called when RNG no longer needed in order to securely free drgb. Zeros and XFREEs rng-drbg...">wc_FreeRng</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
