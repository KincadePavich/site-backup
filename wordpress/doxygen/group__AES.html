<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Algorithms - AES</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Algorithms - AES</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga712dec743cae54ca3f5d3e67eedaa504"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504">wc_AesSetKey</a> (<a class="el" href="structAes.html">Aes</a> *aes, const byte *key, word32 len, const byte *iv, int dir)</td></tr>
<tr class="memdesc:ga712dec743cae54ca3f5d3e67eedaa504"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes an AES structure by setting the key and then setting the initialization vector.  <a href="#ga712dec743cae54ca3f5d3e67eedaa504">More...</a><br /></td></tr>
<tr class="separator:ga712dec743cae54ca3f5d3e67eedaa504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf7bd8d861fbd229429725a918fd85a12"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12">wc_AesSetIV</a> (<a class="el" href="structAes.html">Aes</a> *aes, const byte *iv)</td></tr>
<tr class="memdesc:gaf7bd8d861fbd229429725a918fd85a12"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the initialization vector for a particular AES object. The AES object should be initialized before calling this function.  <a href="#gaf7bd8d861fbd229429725a918fd85a12">More...</a><br /></td></tr>
<tr class="separator:gaf7bd8d861fbd229429725a918fd85a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1466f105e2e23ce9d3b044bc20bc07f2"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga1466f105e2e23ce9d3b044bc20bc07f2">wc_AesCbcEncrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga1466f105e2e23ce9d3b044bc20bc07f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the output buffer out using cipher block chaining with AES. This function requires that the AES object has been initialized by calling AesSetKey before a message is able to be encrypted. This function assumes that the input message is AES block length aligned. PKCS#7 style padding should be added beforehand. This differs from the OpenSSL AES-CBC methods which add the padding for you. To make the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> function and equivalent OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> AesCbcEncrypt method and does not add extra padding during encryption.  <a href="#ga1466f105e2e23ce9d3b044bc20bc07f2">More...</a><br /></td></tr>
<tr class="separator:ga1466f105e2e23ce9d3b044bc20bc07f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga87c89c64e24e60fb1a636bcc6efbae73"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga87c89c64e24e60fb1a636bcc6efbae73">wc_AesCbcDecrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga87c89c64e24e60fb1a636bcc6efbae73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function requires that the AES structure has been initialized by calling AesSetKey before a message is able to be decrypted. This function assumes that the original message was AES block length aligned. This differs from the OpenSSL AES-CBC methods which do not require alignment as it adds PKCS#7 padding automatically. To make the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> function and equivalent OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> AesCbcEncrypt method and does not create errors during decryption.  <a href="#ga87c89c64e24e60fb1a636bcc6efbae73">More...</a><br /></td></tr>
<tr class="separator:ga87c89c64e24e60fb1a636bcc6efbae73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19af25c72f0ff4815ba6978e5e3ed5a1"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga19af25c72f0ff4815ba6978e5e3ed5a1">wc_AesCtrEncrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 sz)</td></tr>
<tr class="memdesc:ga19af25c72f0ff4815ba6978e5e3ed5a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypts/Decrypts a message from the input buffer in, and places the resulting cipher text in the output buffer out using CTR mode with AES. This function is only enabled if WOLFSSL_AES_COUNTER is enabled at compile time. The AES structure should be initialized through AesSetKey before calling this function. Note that this function is used for both decryption and encryption.  <a href="#ga19af25c72f0ff4815ba6978e5e3ed5a1">More...</a><br /></td></tr>
<tr class="separator:ga19af25c72f0ff4815ba6978e5e3ed5a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad3024b8e0a8c87e4f3eedd8ac30e82df"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gad3024b8e0a8c87e4f3eedd8ac30e82df">wc_AesEncryptDirect</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in)</td></tr>
<tr class="memdesc:gad3024b8e0a8c87e4f3eedd8ac30e82df"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled.  <a href="#gad3024b8e0a8c87e4f3eedd8ac30e82df">More...</a><br /></td></tr>
<tr class="separator:gad3024b8e0a8c87e4f3eedd8ac30e82df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac7bd2aaa18433fa2a72d301818fa84a4"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gac7bd2aaa18433fa2a72d301818fa84a4">wc_AesDecryptDirect</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in)</td></tr>
<tr class="memdesc:gac7bd2aaa18433fa2a72d301818fa84a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled, and there is support for direct AES encryption on the system in question.  <a href="#gac7bd2aaa18433fa2a72d301818fa84a4">More...</a><br /></td></tr>
<tr class="separator:gac7bd2aaa18433fa2a72d301818fa84a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8334d68fb641489f93832250fd8772b"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b">wc_AesSetKeyDirect</a> (<a class="el" href="structAes.html">Aes</a> *aes, const byte *key, word32 len, const byte *iv, int dir)</td></tr>
<tr class="memdesc:gaa8334d68fb641489f93832250fd8772b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with the given key, iv (initialization vector), and encryption dir (direction). It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. Currently wc_AesSetKeyDirect uses wc_AesSetKey internally.  <a href="#gaa8334d68fb641489f93832250fd8772b">More...</a><br /></td></tr>
<tr class="separator:gaa8334d68fb641489f93832250fd8772b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga807d1fb3bb9a2f2e7a1aa269706666cc"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga807d1fb3bb9a2f2e7a1aa269706666cc">wc_AesGcmSetKey</a> (<a class="el" href="structAes.html">Aes</a> *aes, const byte *key, word32 len)</td></tr>
<tr class="memdesc:ga807d1fb3bb9a2f2e7a1aa269706666cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object with the given key. It is only enabled if the configure option HAVE_AESGCM is enabled at compile time.  <a href="#ga807d1fb3bb9a2f2e7a1aa269706666cc">More...</a><br /></td></tr>
<tr class="separator:ga807d1fb3bb9a2f2e7a1aa269706666cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga512cda371bd4f72c5ec836ddea29ce7a"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga512cda371bd4f72c5ec836ddea29ce7a">wc_AesGcmEncrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga512cda371bd4f72c5ec836ddea29ce7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function encrypts the input message, held in the buffer in, and stores the resulting cipher text in the output buffer out. It requires a new iv (initialization vector) for each call to encrypt. It also encodes the input authentication vector, authIn, into the authentication tag, authTag.  <a href="#ga512cda371bd4f72c5ec836ddea29ce7a">More...</a><br /></td></tr>
<tr class="separator:ga512cda371bd4f72c5ec836ddea29ce7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga278f3e5a4b8b2f341c19a0751ff2de57"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga278f3e5a4b8b2f341c19a0751ff2de57">wc_AesGcmDecrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:ga278f3e5a4b8b2f341c19a0751ff2de57"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function decrypts the input cipher text, held in the buffer in, and stores the resulting message text in the output buffer out. It also checks the input authentication vector, authIn, against the supplied authentication tag, authTag.  <a href="#ga278f3e5a4b8b2f341c19a0751ff2de57">More...</a><br /></td></tr>
<tr class="separator:ga278f3e5a4b8b2f341c19a0751ff2de57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga656b05eb12dcdd9a864aff030a0f84cb"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga656b05eb12dcdd9a864aff030a0f84cb">wc_GmacSetKey</a> (<a class="el" href="structGmac.html">Gmac</a> *gmac, const byte *key, word32 len)</td></tr>
<tr class="memdesc:ga656b05eb12dcdd9a864aff030a0f84cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes and sets the key for a GMAC object to be used for Galois Message Authentication.  <a href="#ga656b05eb12dcdd9a864aff030a0f84cb">More...</a><br /></td></tr>
<tr class="separator:ga656b05eb12dcdd9a864aff030a0f84cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad394ab026b167bbd81c49eb4f75283aa"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gad394ab026b167bbd81c49eb4f75283aa">wc_GmacUpdate</a> (<a class="el" href="structGmac.html">Gmac</a> *gmac, const byte *iv, word32 ivSz, const byte *authIn, word32 authInSz, byte *authTag, word32 authTagSz)</td></tr>
<tr class="memdesc:gad394ab026b167bbd81c49eb4f75283aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates the <a class="el" href="structGmac.html">Gmac</a> hash of the authIn input and stores the result in the authTag buffer. After running wc_GmacUpdate, one should compare the generated authTag to a known authentication tag to verify the authenticity of a message.  <a href="#gad394ab026b167bbd81c49eb4f75283aa">More...</a><br /></td></tr>
<tr class="separator:gad394ab026b167bbd81c49eb4f75283aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7544488439c4bd369e14e9613f21df9a"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#ga7544488439c4bd369e14e9613f21df9a">wc_AesCcmSetKey</a> (<a class="el" href="structAes.html">Aes</a> *aes, const byte *key, word32 keySz)</td></tr>
<tr class="memdesc:ga7544488439c4bd369e14e9613f21df9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to an AES structure and initializes it with supplied key.  <a href="#ga7544488439c4bd369e14e9613f21df9a">More...</a><br /></td></tr>
<tr class="separator:ga7544488439c4bd369e14e9613f21df9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad09e65d89dc98d674ed06222a0e8305a"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gad09e65d89dc98d674ed06222a0e8305a">wc_AesCcmEncrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:gad09e65d89dc98d674ed06222a0e8305a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates and stores the authorization tag, authTag, from the authIn input.  <a href="#gad09e65d89dc98d674ed06222a0e8305a">More...</a><br /></td></tr>
<tr class="separator:gad09e65d89dc98d674ed06222a0e8305a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd7b25bd041af0b9e5d4d5ba9512065e"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gabd7b25bd041af0b9e5d4d5ba9512065e">wc_AesCcmDecrypt</a> (<a class="el" href="structAes.html">Aes</a> *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</td></tr>
<tr class="memdesc:gabd7b25bd041af0b9e5d4d5ba9512065e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates the authorization tag, authTag, from the authIn input. If the authorization tag is invalid, it sets the output buffer to zero and returns the error: AES_CCM_AUTH_E.  <a href="#gabd7b25bd041af0b9e5d4d5ba9512065e">More...</a><br /></td></tr>
<tr class="separator:gabd7b25bd041af0b9e5d4d5ba9512065e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf4a0e3ae5b10ed5d581a02074c458a9"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__AES.html#gabf4a0e3ae5b10ed5d581a02074c458a9">wc_AesCbcDecryptWithKey</a> (byte *out, const byte *in, word32 inSz, const byte *key, word32 keySz, const byte *iv)</td></tr>
<tr class="memdesc:gabf4a0e3ae5b10ed5d581a02074c458a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function does not require an AES structure to be initialized. Instead, it takes in a key and an iv (initialization vector) and uses these to initialize an AES object and then decrypt the cipher text.  <a href="#gabf4a0e3ae5b10ed5d581a02074c458a9">More...</a><br /></td></tr>
<tr class="separator:gabf4a0e3ae5b10ed5d581a02074c458a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga87c89c64e24e60fb1a636bcc6efbae73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga87c89c64e24e60fb1a636bcc6efbae73">&#9670;&nbsp;</a></span>wc_AesCbcDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesCbcDecrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function requires that the AES structure has been initialized by calling AesSetKey before a message is able to be decrypted. This function assumes that the original message was AES block length aligned. This differs from the OpenSSL AES-CBC methods which do not require alignment as it adds PKCS#7 padding automatically. To make the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> function and equivalent OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> AesCbcEncrypt method and does not create errors during decryption. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting message. </dd>
<dd>
BAD_ALIGN_E Returned on block align error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to decrypt data. </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the plain text of the decrypted message. </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing cipher text to be decrypted. </td></tr>
    <tr><td class="paramname">sz</td><td>size of input message.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> dec;</div><div class="line"><span class="keywordtype">int</span> ret = 0;</div><div class="line"><span class="comment">// initialize dec with AesSetKey, using direction AES_DECRYPTION</span></div><div class="line">byte cipher[AES_BLOCK_SIZE * n]; <span class="comment">// some multiple of 16 bytes</span></div><div class="line"><span class="comment">// fill cipher with cipher text</span></div><div class="line">byte plain [AES_BLOCK_SIZE * n];</div><div class="line"><span class="keywordflow">if</span> ((ret = <a class="code" href="group__AES.html#ga87c89c64e24e60fb1a636bcc6efbae73">wc_AesCbcDecrypt</a>(&amp;dec, plain, cipher, <span class="keyword">sizeof</span>(cipher))) != 0 ) {</div><div class="line"><span class="comment">// block align error</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga1466f105e2e23ce9d3b044bc20bc07f2" title="Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the ou...">wc_AesCbcEncrypt</a> </dd></dl>

</div>
</div>
<a id="gabf4a0e3ae5b10ed5d581a02074c458a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabf4a0e3ae5b10ed5d581a02074c458a9">&#9670;&nbsp;</a></span>wc_AesCbcDecryptWithKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesCbcDecryptWithKey </td>
          <td>(</td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>inSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>keySz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer out using cipher block chaining with AES. This function does not require an AES structure to be initialized. Instead, it takes in a key and an iv (initialization vector) and uses these to initialize an AES object and then decrypt the cipher text. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting message </dd>
<dd>
BAD_ALIGN_E Returned on block align error </dd>
<dd>
BAD_FUNC_ARG Returned if key length is invalid or AES object is null during AesSetIV </dd>
<dd>
MEMORY_E Returned if WOLFSSL_SMALL_STACK is enabled and XMALLOC fails to instantiate an AES object.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the plain text of the decrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing cipher text to be decrypted </td></tr>
    <tr><td class="paramname">inSz</td><td>size of input message </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for decryption </td></tr>
    <tr><td class="paramname">keySz</td><td>size of key used for decryption</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> ret = 0;</div><div class="line">byte key[] = { some 16, 24, or 32 byte key };</div><div class="line">byte iv[]  = { some 16 byte iv };</div><div class="line">byte cipher[AES_BLOCK_SIZE * n]; <span class="comment">//n being a positive integer making cipher some multiple of 16 bytes</span></div><div class="line"><span class="comment">// fill cipher with cipher text</span></div><div class="line">byte plain [AES_BLOCK_SIZE * n];</div><div class="line"><span class="keywordflow">if</span> ((ret = <a class="code" href="group__AES.html#gabf4a0e3ae5b10ed5d581a02074c458a9">wc_AesCbcDecryptWithKey</a>(plain, cipher, AES_BLOCK_SIZE, key, AES_BLOCK_SIZE, iv)) != 0 ) {</div><div class="line"><span class="comment">// Decrypt Error</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga1466f105e2e23ce9d3b044bc20bc07f2" title="Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the ou...">wc_AesCbcEncrypt</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga87c89c64e24e60fb1a636bcc6efbae73" title="Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...">wc_AesCbcDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga1466f105e2e23ce9d3b044bc20bc07f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1466f105e2e23ce9d3b044bc20bc07f2">&#9670;&nbsp;</a></span>wc_AesCbcEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesCbcEncrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the output buffer out using cipher block chaining with AES. This function requires that the AES object has been initialized by calling AesSetKey before a message is able to be encrypted. This function assumes that the input message is AES block length aligned. PKCS#7 style padding should be added beforehand. This differs from the OpenSSL AES-CBC methods which add the padding for you. To make the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> function and equivalent OpenSSL functions interoperate, one should specify the -nopad option in the OpenSSL command line function so that it behaves like the <a class="el" href="namespacewolfSSL.html">wolfSSL</a> AesCbcEncrypt method and does not add extra padding during encryption. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully encrypting message. </dd>
<dd>
BAD_ALIGN_E: Returned on block align error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the ciphertext of the encrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing message to be encrypted </td></tr>
    <tr><td class="paramname">sz</td><td>size of input message</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="keywordtype">int</span> ret = 0;</div><div class="line"><span class="comment">// initialize enc with AesSetKey, using direction AES_ENCRYPTION</span></div><div class="line">byte msg[AES_BLOCK_SIZE * n]; <span class="comment">// multiple of 16 bytes</span></div><div class="line"><span class="comment">// fill msg with data</span></div><div class="line">byte cipher[AES_BLOCK_SIZE * n]; <span class="comment">// Some multiple of 16 bytes</span></div><div class="line"><span class="keywordflow">if</span> ((ret = <a class="code" href="group__AES.html#ga1466f105e2e23ce9d3b044bc20bc07f2">wc_AesCbcEncrypt</a>(&amp;enc, cipher, message, <span class="keyword">sizeof</span>(msg))) != 0 ) {</div><div class="line"><span class="comment">// block align error</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga87c89c64e24e60fb1a636bcc6efbae73" title="Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...">wc_AesCbcDecrypt</a> </dd></dl>

</div>
</div>
<a id="gabd7b25bd041af0b9e5d4d5ba9512065e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabd7b25bd041af0b9e5d4d5ba9512065e">&#9670;&nbsp;</a></span>wc_AesCcmDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesCcmDecrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>inSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>nonceSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authTagSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authInSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates the authorization tag, authTag, from the authIn input. If the authorization tag is invalid, it sets the output buffer to zero and returns the error: AES_CCM_AUTH_E. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting the input message </dd>
<dd>
AES_CCM_AUTH_E If the authentication tag does not match the supplied authentication code vector, authTag.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the message to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>length of the input cipher text to decrypt </td></tr>
    <tr><td class="paramname">nonce</td><td>pointer to the buffer containing the nonce (number only used once) </td></tr>
    <tr><td class="paramname">nonceSz</td><td>length of the nonce </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> dec;</div><div class="line"><span class="comment">// initialize dec with wc_AesCcmSetKey</span></div><div class="line"></div><div class="line">nonce[] = { initialize nonce };</div><div class="line">cipher[] = { encrypted message };</div><div class="line">plain[<span class="keyword">sizeof</span>(cipher)];</div><div class="line"></div><div class="line">authIn[] = { some 16 byte authentication input };</div><div class="line">tag[AES_BLOCK_SIZE] = { authentication tag received <span class="keywordflow">for</span> verification };</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <span class="keywordflow">return</span> = <a class="code" href="group__AES.html#gabd7b25bd041af0b9e5d4d5ba9512065e">wc_AesCcmDecrypt</a>(&amp;dec, plain, cipher, <span class="keyword">sizeof</span>(cipher), nonce, <span class="keyword">sizeof</span>(nonce),tag, <span class="keyword">sizeof</span>(tag), authIn, <span class="keyword">sizeof</span>(authIn));</div><div class="line"><span class="keywordflow">if</span>(<span class="keywordflow">return</span> != 0) {</div><div class="line"><span class="comment">// decrypt error, invalid authentication code</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga7544488439c4bd369e14e9613f21df9a" title="This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to ...">wc_AesCcmSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#gad09e65d89dc98d674ed06222a0e8305a" title="This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CB...">wc_AesCcmEncrypt</a> </dd></dl>

</div>
</div>
<a id="gad09e65d89dc98d674ed06222a0e8305a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad09e65d89dc98d674ed06222a0e8305a">&#9670;&nbsp;</a></span>wc_AesCcmEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesCcmEncrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>inSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>nonceSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>authTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authTagSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authInSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CBC-MAC). It subsequently calculates and stores the authorization tag, authTag, from the authIn input. </p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the message to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>length of the input message to encrypt </td></tr>
    <tr><td class="paramname">nonce</td><td>pointer to the buffer containing the nonce (number only used once) </td></tr>
    <tr><td class="paramname">nonceSz</td><td>length of the nonce </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="comment">// initialize enc with wc_AesCcmSetKey</span></div><div class="line"></div><div class="line">nonce[] = { initialize nonce };</div><div class="line">plain[] = { some plain text message };</div><div class="line">cipher[<span class="keyword">sizeof</span>(plain)];</div><div class="line"></div><div class="line">authIn[] = { some 16 byte authentication input };</div><div class="line">tag[AES_BLOCK_SIZE]; <span class="comment">// will store authentication code</span></div><div class="line"></div><div class="line"><a class="code" href="group__AES.html#gad09e65d89dc98d674ed06222a0e8305a">wc_AesCcmEncrypt</a>(&amp;enc, cipher, plain, <span class="keyword">sizeof</span>(plain), nonce, <span class="keyword">sizeof</span>(nonce),</div><div class="line">        tag, <span class="keyword">sizeof</span>(tag), authIn, <span class="keyword">sizeof</span>(authIn));</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga7544488439c4bd369e14e9613f21df9a" title="This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to ...">wc_AesCcmSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#gabd7b25bd041af0b9e5d4d5ba9512065e" title="This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter wit...">wc_AesCcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga7544488439c4bd369e14e9613f21df9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7544488439c4bd369e14e9613f21df9a">&#9670;&nbsp;</a></span>wc_AesCcmSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesCcmSetKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>keySz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to an AES structure and initializes it with supplied key. </p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>aes structure in which to store the supplied key </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">keySz</td><td>size of the supplied key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line">key[] = { some 16, 24, or 32 byte length key };</div><div class="line"></div><div class="line"><a class="code" href="group__AES.html#ga7544488439c4bd369e14e9613f21df9a">wc_AesCcmSetKey</a>(&amp;aes, key, <span class="keyword">sizeof</span>(key));</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gad09e65d89dc98d674ed06222a0e8305a" title="This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CB...">wc_AesCcmEncrypt</a> </dd>
<dd>
<a class="el" href="group__AES.html#gabd7b25bd041af0b9e5d4d5ba9512065e" title="This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter wit...">wc_AesCcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga19af25c72f0ff4815ba6978e5e3ed5a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19af25c72f0ff4815ba6978e5e3ed5a1">&#9670;&nbsp;</a></span>wc_AesCtrEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API void wc_AesCtrEncrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>sz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypts/Decrypts a message from the input buffer in, and places the resulting cipher text in the output buffer out using CTR mode with AES. This function is only enabled if WOLFSSL_AES_COUNTER is enabled at compile time. The AES structure should be initialized through AesSetKey before calling this function. Note that this function is used for both decryption and encryption. </p>
<p><em>NOTE:</em> Regarding using same API for encryption and decryption. User should differentiate between <a class="el" href="structAes.html">Aes</a> structures for encrypt/decrypt.</p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to decrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text of the encrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing plain text to be encrypted </td></tr>
    <tr><td class="paramname">sz</td><td>size of the input plain text</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><a class="code" href="structAes.html">Aes</a> dec;</div><div class="line"><span class="comment">// initialize enc and dec with AesSetKeyDirect, using direction AES_ENCRYPTION</span></div><div class="line"><span class="comment">// since the underlying API only calls Encrypt and by default calling encrypt on</span></div><div class="line"><span class="comment">// a cipher results in a decryption of the cipher</span></div><div class="line"></div><div class="line">byte msg[AES_BLOCK_SIZE * n]; <span class="comment">//n being a positive integer making msg some multiple of 16 bytes</span></div><div class="line"><span class="comment">// fill plain with message text</span></div><div class="line">byte cipher[AES_BLOCK_SIZE * n];</div><div class="line">byte decrypted[AES_BLOCK_SIZE * n];</div><div class="line"><a class="code" href="group__AES.html#ga19af25c72f0ff4815ba6978e5e3ed5a1">wc_AesCtrEncrypt</a>(&amp;enc, cipher, msg, <span class="keyword">sizeof</span>(msg)); <span class="comment">// encrypt plain</span></div><div class="line"><a class="code" href="group__AES.html#ga19af25c72f0ff4815ba6978e5e3ed5a1">wc_AesCtrEncrypt</a>(&amp;dec, decrypted, cipher, <span class="keyword">sizeof</span>(cipher)); <span class="comment">// decrypt cipher text</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="gac7bd2aaa18433fa2a72d301818fa84a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac7bd2aaa18433fa2a72d301818fa84a4">&#9670;&nbsp;</a></span>wc_AesDecryptDirect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API void wc_AesDecryptDirect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled, and there is support for direct AES encryption on the system in question. </p>
<p><b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB APIs directly whenever possible</p>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the plain text of the decrypted cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing cipher text to be decrypted</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> dec;</div><div class="line"><span class="comment">// initialize enc with AesSetKey, using direction AES_DECRYPTION</span></div><div class="line">byte cipher [AES_BLOCK_SIZE]; <span class="comment">// 16 bytes</span></div><div class="line"><span class="comment">// initialize cipher with cipher text to decrypt</span></div><div class="line">byte msg[AES_BLOCK_SIZE];</div><div class="line"><a class="code" href="group__AES.html#gac7bd2aaa18433fa2a72d301818fa84a4">wc_AesDecryptDirect</a>(&amp;dec, msg, cipher);</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gad3024b8e0a8c87e4f3eedd8ac30e82df" title="This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. ">wc_AesEncryptDirect</a> </dd>
<dd>
<a class="el" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd></dl>

</div>
</div>
<a id="gad3024b8e0a8c87e4f3eedd8ac30e82df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad3024b8e0a8c87e4f3eedd8ac30e82df">&#9670;&nbsp;</a></span>wc_AesEncryptDirect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API void wc_AesEncryptDirect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. </p>
<p><b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB APIs directly whenever possible</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text of the encrypted message </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer containing plain text to be encrypted</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="comment">// initialize enc with AesSetKey, using direction AES_ENCRYPTION</span></div><div class="line">byte msg [AES_BLOCK_SIZE]; <span class="comment">// 16 bytes</span></div><div class="line"><span class="comment">// initialize msg with plain text to encrypt</span></div><div class="line">byte cipher[AES_BLOCK_SIZE];</div><div class="line"><a class="code" href="group__AES.html#gad3024b8e0a8c87e4f3eedd8ac30e82df">wc_AesEncryptDirect</a>(&amp;enc, cipher, msg);</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gac7bd2aaa18433fa2a72d301818fa84a4" title="This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled, and there is support for direct AES encryption on the system in question. ">wc_AesDecryptDirect</a> </dd>
<dd>
<a class="el" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd></dl>

</div>
</div>
<a id="ga278f3e5a4b8b2f341c19a0751ff2de57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga278f3e5a4b8b2f341c19a0751ff2de57">&#9670;&nbsp;</a></span>wc_AesGcmDecrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesGcmDecrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>sz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>ivSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authTagSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authInSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function decrypts the input cipher text, held in the buffer in, and stores the resulting message text in the output buffer out. It also checks the input authentication vector, authIn, against the supplied authentication tag, authTag. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully decrypting the input message </dd>
<dd>
AES_GCM_AUTH_E If the authentication tag does not match the supplied authentication code vector, authTag.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the message text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the cipher text to decrypt </td></tr>
    <tr><td class="paramname">sz</td><td>length of the cipher text to decrypt </td></tr>
    <tr><td class="paramname">iv</td><td>pointer to the buffer containing the initialization vector </td></tr>
    <tr><td class="paramname">ivSz</td><td>length of the initialization vector </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer containing the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc; <span class="comment">//can use the same struct as was passed to wc_AesGcmEncrypt </span></div><div class="line"><span class="comment">// initialize aes structure by calling wc_AesGcmSetKey if not already done</span></div><div class="line"></div><div class="line">byte cipher[AES_BLOCK_LENGTH * n]; <span class="comment">//n being a positive integer making cipher some multiple of 16 bytes</span></div><div class="line"><span class="comment">// initialize cipher with cipher text to decrypt</span></div><div class="line">byte output[<span class="keyword">sizeof</span>(cipher)];</div><div class="line">byte iv[] = <span class="comment">// some 16 byte iv</span></div><div class="line">byte authTag[AUTH_TAG_LENGTH];</div><div class="line">byte authIn[] = <span class="comment">// Authentication Vector</span></div><div class="line"></div><div class="line"><a class="code" href="group__AES.html#ga278f3e5a4b8b2f341c19a0751ff2de57">wc_AesGcmDecrypt</a>(&amp;enc, output, cipher, <span class="keyword">sizeof</span>(cipher), iv, <span class="keyword">sizeof</span>(iv),</div><div class="line">        authTag, <span class="keyword">sizeof</span>(authTag), authIn, <span class="keyword">sizeof</span>(authIn));</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga807d1fb3bb9a2f2e7a1aa269706666cc" title="This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object ...">wc_AesGcmSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga512cda371bd4f72c5ec836ddea29ce7a" title="This function encrypts the input message, held in the buffer in, and stores the resulting cipher text...">wc_AesGcmEncrypt</a> </dd></dl>

</div>
</div>
<a id="ga512cda371bd4f72c5ec836ddea29ce7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga512cda371bd4f72c5ec836ddea29ce7a">&#9670;&nbsp;</a></span>wc_AesGcmEncrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesGcmEncrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>sz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>ivSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>authTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authTagSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authInSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function encrypts the input message, held in the buffer in, and stores the resulting cipher text in the output buffer out. It requires a new iv (initialization vector) for each call to encrypt. It also encodes the input authentication vector, authIn, into the authentication tag, authTag. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully encrypting the input message</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>- pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">out</td><td>pointer to the output buffer in which to store the cipher text </td></tr>
    <tr><td class="paramname">in</td><td>pointer to the input buffer holding the message to encrypt </td></tr>
    <tr><td class="paramname">sz</td><td>length of the input message to encrypt </td></tr>
    <tr><td class="paramname">iv</td><td>pointer to the buffer containing the initialization vector </td></tr>
    <tr><td class="paramname">ivSz</td><td>length of the initialization vector </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the buffer in which to store the authentication tag </td></tr>
    <tr><td class="paramname">authTagSz</td><td>length of the desired authentication tag </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the input authentication vector </td></tr>
    <tr><td class="paramname">authInSz</td><td>length of the input authentication vector</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="comment">// initialize aes structure by calling wc_AesGcmSetKey</span></div><div class="line"></div><div class="line">byte plain[AES_BLOCK_LENGTH * n]; <span class="comment">//n being a positive integer making plain some multiple of 16 bytes</span></div><div class="line"><span class="comment">// initialize plain with msg to encrypt</span></div><div class="line">byte cipher[<span class="keyword">sizeof</span>(plain)];</div><div class="line">byte iv[] = <span class="comment">// some 16 byte iv</span></div><div class="line">byte authTag[AUTH_TAG_LENGTH];</div><div class="line">byte authIn[] = <span class="comment">// Authentication Vector</span></div><div class="line"></div><div class="line"><a class="code" href="group__AES.html#ga512cda371bd4f72c5ec836ddea29ce7a">wc_AesGcmEncrypt</a>(&amp;enc, cipher, plain, <span class="keyword">sizeof</span>(cipher), iv, <span class="keyword">sizeof</span>(iv),</div><div class="line">        authTag, <span class="keyword">sizeof</span>(authTag), authIn, <span class="keyword">sizeof</span>(authIn));</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga807d1fb3bb9a2f2e7a1aa269706666cc" title="This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object ...">wc_AesGcmSetKey</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga278f3e5a4b8b2f341c19a0751ff2de57" title="This function decrypts the input cipher text, held in the buffer in, and stores the resulting message...">wc_AesGcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="ga807d1fb3bb9a2f2e7a1aa269706666cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga807d1fb3bb9a2f2e7a1aa269706666cc">&#9670;&nbsp;</a></span>wc_AesGcmSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesGcmSetKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object with the given key. It is only enabled if the configure option HAVE_AESGCM is enabled at compile time. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting the key. </dd>
<dd>
BAD_FUNC_ARG Returned if the given key is an invalid length.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">len</td><td>length of the key passed in</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="keywordtype">int</span> ret = 0;</div><div class="line">byte key[] = { some 16, 24,32 byte key };</div><div class="line"><span class="keywordflow">if</span> (ret = <a class="code" href="group__AES.html#ga807d1fb3bb9a2f2e7a1aa269706666cc">wc_AesGcmSetKey</a>(&amp;enc, key, <span class="keyword">sizeof</span>(key)) != 0) {</div><div class="line"><span class="comment">// failed to set aes key</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga512cda371bd4f72c5ec836ddea29ce7a" title="This function encrypts the input message, held in the buffer in, and stores the resulting cipher text...">wc_AesGcmEncrypt</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga278f3e5a4b8b2f341c19a0751ff2de57" title="This function decrypts the input cipher text, held in the buffer in, and stores the resulting message...">wc_AesGcmDecrypt</a> </dd></dl>

</div>
</div>
<a id="gaf7bd8d861fbd229429725a918fd85a12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf7bd8d861fbd229429725a918fd85a12">&#9670;&nbsp;</a></span>wc_AesSetIV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesSetIV </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the initialization vector for a particular AES object. The AES object should be initialized before calling this function. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting initialization vector. </dd>
<dd>
BAD_FUNC_ARG Returned if AES pointer is NULL.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES structure on which to set the initialization vector </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector used to initialize the AES structure. If the value is NULL, the default action initializes the iv to 0.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="comment">// set enc key</span></div><div class="line">byte iv[]  = { some 16 byte iv };</div><div class="line"><span class="keywordflow">if</span> (ret = <a class="code" href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12">wc_AesSetIV</a>(&amp;enc, iv) != 0) {</div><div class="line"><span class="comment">// failed to set aes iv</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="ga712dec743cae54ca3f5d3e67eedaa504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga712dec743cae54ca3f5d3e67eedaa504">&#9670;&nbsp;</a></span>wc_AesSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesSetKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes an AES structure by setting the key and then setting the initialization vector. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting key and initialization vector. </dd>
<dd>
BAD_FUNC_ARG Returned if key length is invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES structure to modify </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">len</td><td>length of the key passed in </td></tr>
    <tr><td class="paramname">iv</td><td>pointer to the initialization vector used to initialize the key </td></tr>
    <tr><td class="paramname">dir</td><td>Cipher direction. Set AES_ENCRYPTION to encrypt, or AES_DECRYPTION to decrypt.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="keywordtype">int</span> ret = 0;</div><div class="line">byte key[] = { some 16, 24 or 32 byte key };</div><div class="line">byte iv[]  = { some 16 byte iv };</div><div class="line"><span class="keywordflow">if</span> (ret = <a class="code" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504">wc_AesSetKey</a>(&amp;enc, key, AES_BLOCK_SIZE, iv, AES_ENCRYPTION) != 0) {</div><div class="line"><span class="comment">// failed to set aes key</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b" title="This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...">wc_AesSetKeyDirect</a> </dd>
<dd>
<a class="el" href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12" title="This function sets the initialization vector for a particular AES object. The AES object should be in...">wc_AesSetIV</a> </dd></dl>

</div>
</div>
<a id="gaa8334d68fb641489f93832250fd8772b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa8334d68fb641489f93832250fd8772b">&#9670;&nbsp;</a></span>wc_AesSetKeyDirect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_AesSetKeyDirect </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structAes.html">Aes</a> *&#160;</td>
          <td class="paramname"><em>aes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with the given key, iv (initialization vector), and encryption dir (direction). It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. Currently wc_AesSetKeyDirect uses wc_AesSetKey internally. </p>
<p><b>Warning:</b> In nearly all use cases ECB mode is considered to be less secure. Please avoid using ECB APIs directly whenever possible</p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting the key. </dd>
<dd>
BAD_FUNC_ARG Returned if the given key is an invalid length.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aes</td><td>pointer to the AES object used to encrypt data </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for encryption and decryption </td></tr>
    <tr><td class="paramname">len</td><td>length of the key passed in </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector used to initialize the key </td></tr>
    <tr><td class="paramname">dir</td><td>Cipher direction. Set AES_ENCRYPTION to encrypt, or AES_DECRYPTION to decrypt. (See enum in <a class="el" href="wolfssl_2wolfcrypt_2aes_8h_source.html">wolfssl/wolfcrypt/aes.h</a>) (NOTE: If using wc_AesSetKeyDirect with <a class="el" href="structAes.html">Aes</a> Counter mode (Stream cipher) only use AES_ENCRYPTION for both encrypting and decrypting)</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structAes.html">Aes</a> enc;</div><div class="line"><span class="keywordtype">int</span> ret = 0;</div><div class="line">byte key[] = { some 16, 24, or 32 byte key };</div><div class="line">byte iv[]  = { some 16 byte iv };</div><div class="line"><span class="keywordflow">if</span> (ret = <a class="code" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b">wc_AesSetKeyDirect</a>(&amp;enc, key, <span class="keyword">sizeof</span>(key), iv, AES_ENCRYPTION) != 0) {</div><div class="line"><span class="comment">// failed to set aes key</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gad3024b8e0a8c87e4f3eedd8ac30e82df" title="This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. ">wc_AesEncryptDirect</a> </dd>
<dd>
<a class="el" href="group__AES.html#gac7bd2aaa18433fa2a72d301818fa84a4" title="This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled, and there is support for direct AES encryption on the system in question. ">wc_AesDecryptDirect</a> </dd>
<dd>
<a class="el" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504" title="This function initializes an AES structure by setting the key and then setting the initialization vec...">wc_AesSetKey</a> </dd></dl>

</div>
</div>
<a id="ga656b05eb12dcdd9a864aff030a0f84cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga656b05eb12dcdd9a864aff030a0f84cb">&#9670;&nbsp;</a></span>wc_GmacSetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_GmacSetKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGmac.html">Gmac</a> *&#160;</td>
          <td class="paramname"><em>gmac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes and sets the key for a GMAC object to be used for Galois Message Authentication. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully setting the key </dd>
<dd>
BAD_FUNC_ARG Returned if key length is invalid.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gmac</td><td>pointer to the gmac object used for authentication </td></tr>
    <tr><td class="paramname">key</td><td>16, 24, or 32 byte secret key for authentication </td></tr>
    <tr><td class="paramname">len</td><td>length of the key</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structGmac.html">Gmac</a> gmac;</div><div class="line">key[] = { some 16, 24, or 32 byte length key };</div><div class="line"><a class="code" href="group__AES.html#ga656b05eb12dcdd9a864aff030a0f84cb">wc_GmacSetKey</a>(&amp;gmac, key, <span class="keyword">sizeof</span>(key));</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#gad394ab026b167bbd81c49eb4f75283aa" title="This function generates the Gmac hash of the authIn input and stores the result in the authTag buffer...">wc_GmacUpdate</a> </dd></dl>

</div>
</div>
<a id="gad394ab026b167bbd81c49eb4f75283aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad394ab026b167bbd81c49eb4f75283aa">&#9670;&nbsp;</a></span>wc_GmacUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_GmacUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structGmac.html">Gmac</a> *&#160;</td>
          <td class="paramname"><em>gmac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>ivSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>authIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authInSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>authTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>authTagSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates the <a class="el" href="structGmac.html">Gmac</a> hash of the authIn input and stores the result in the authTag buffer. After running wc_GmacUpdate, one should compare the generated authTag to a known authentication tag to verify the authenticity of a message. </p>
<dl class="section return"><dt>Returns</dt><dd>0 On successfully computing the <a class="el" href="structGmac.html">Gmac</a> hash.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gmac</td><td>pointer to the gmac object used for authentication </td></tr>
    <tr><td class="paramname">iv</td><td>initialization vector used for the hash </td></tr>
    <tr><td class="paramname">ivSz</td><td>size of the initialization vector used </td></tr>
    <tr><td class="paramname">authIn</td><td>pointer to the buffer containing the authentication vector to verify </td></tr>
    <tr><td class="paramname">authInSz</td><td>size of the authentication vector </td></tr>
    <tr><td class="paramname">authTag</td><td>pointer to the output buffer in which to store the <a class="el" href="structGmac.html">Gmac</a> hash </td></tr>
    <tr><td class="paramname">authTagSz</td><td>the size of the output buffer used to store the <a class="el" href="structGmac.html">Gmac</a> hash</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structGmac.html">Gmac</a> gmac;</div><div class="line">key[] = { some 16, 24, or 32 byte length key };</div><div class="line">iv[] = { some 16 byte length iv };</div><div class="line"></div><div class="line"><a class="code" href="group__AES.html#ga656b05eb12dcdd9a864aff030a0f84cb">wc_GmacSetKey</a>(&amp;gmac, key, <span class="keyword">sizeof</span>(key));</div><div class="line">authIn[] = { some 16 byte authentication input };</div><div class="line">tag[AES_BLOCK_SIZE]; <span class="comment">// will store authentication code</span></div><div class="line"></div><div class="line"><a class="code" href="group__AES.html#gad394ab026b167bbd81c49eb4f75283aa">wc_GmacUpdate</a>(&amp;gmac, iv, <span class="keyword">sizeof</span>(iv), authIn, <span class="keyword">sizeof</span>(authIn), tag, <span class="keyword">sizeof</span>(tag));</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__AES.html#ga656b05eb12dcdd9a864aff030a0f84cb" title="This function initializes and sets the key for a GMAC object to be used for Galois Message Authentica...">wc_GmacSetKey</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
