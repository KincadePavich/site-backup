<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Algorithms - Password Based</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Algorithms - Password Based</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga744b805fda60c99a590ce7d6896e836a"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Password.html#ga744b805fda60c99a590ce7d6896e836a">wc_PBKDF2</a> (byte *output, const byte *passwd, int pLen, const byte *salt, int sLen, int iterations, int kLen, int typeH)</td></tr>
<tr class="memdesc:ga744b805fda60c99a590ce7d6896e836a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the Password Based Key Derivation Function 2 (PBKDF2), converting an input password with a concatenated salt into a more secure key, which it stores in output. It allows the user to select any of the supported HMAC hash functions, including: MD5, SHA, SHA256, SHA384, SHA512, and BLAKE2B.  <a href="#ga744b805fda60c99a590ce7d6896e836a">More...</a><br /></td></tr>
<tr class="separator:ga744b805fda60c99a590ce7d6896e836a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae230fdb63b747108d20b95d064b717cd"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Password.html#gae230fdb63b747108d20b95d064b717cd">wc_PKCS12_PBKDF</a> (byte *output, const byte *passwd, int pLen, const byte *salt, int sLen, int iterations, int kLen, int typeH, int purpose)</td></tr>
<tr class="memdesc:gae230fdb63b747108d20b95d064b717cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the Password Based Key Derivation Function (PBKDF) described in RFC 7292 Appendix B. This function converts an input password with a concatenated salt into a more secure key, which it stores in output. It allows the user to select any of the supported HMAC hash functions, including: MD5, SHA, SHA256, SHA384, SHA512, and BLAKE2B.  <a href="#gae230fdb63b747108d20b95d064b717cd">More...</a><br /></td></tr>
<tr class="separator:gae230fdb63b747108d20b95d064b717cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga744b805fda60c99a590ce7d6896e836a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga744b805fda60c99a590ce7d6896e836a">&#9670;&nbsp;</a></span>wc_PBKDF2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_PBKDF2 </td>
          <td>(</td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>passwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>typeH</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function implements the Password Based Key Derivation Function 2 (PBKDF2), converting an input password with a concatenated salt into a more secure key, which it stores in output. It allows the user to select any of the supported HMAC hash functions, including: MD5, SHA, SHA256, SHA384, SHA512, and BLAKE2B. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully deriving a key from the input password </dd>
<dd>
BAD_FUNC_ARG Returned if there is an invalid hash type given or iterations is less than 1 </dd>
<dd>
MEMORY_E Returned if there is an allocating memory for the HMAC object</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the generated key. Should be kLen long </td></tr>
    <tr><td class="paramname">passwd</td><td>pointer to the buffer containing the password to use for the key derivation </td></tr>
    <tr><td class="paramname">pLen</td><td>length of the password to use for key derivation </td></tr>
    <tr><td class="paramname">salt</td><td>pointer to the buffer containing the salt to use for key derivation </td></tr>
    <tr><td class="paramname">sLen</td><td>length of the salt </td></tr>
    <tr><td class="paramname">iterations</td><td>number of times to process the hash </td></tr>
    <tr><td class="paramname">kLen</td><td>desired length of the derived key </td></tr>
    <tr><td class="paramname">hashType</td><td>the hashing algorithm to use. Valid choices are: MD5, SHA, SHA256, SHA384, SHA512, and BLAKE2B</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> ret;</div><div class="line">byte key[64];</div><div class="line">byte pass[] = { <span class="comment">/* initialize with password };</span></div><div class="line"><span class="comment">byte salt[] = { /* initialize with salt };</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">ret = wc_PBKDF2(key, pass, sizeof(pass), salt, sizeof(salt), 2048, sizeof(key), </span></div><div class="line"><span class="comment">SHA512);</span></div><div class="line"><span class="comment">if ( ret != 0 ) {</span></div><div class="line"><span class="comment">    // error deriving key from password</span></div><div class="line"><span class="comment">}</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_PBKDF1 </dd>
<dd>
<a class="el" href="group__Password.html#gae230fdb63b747108d20b95d064b717cd" title="This function implements the Password Based Key Derivation Function (PBKDF) described in RFC 7292 App...">wc_PKCS12_PBKDF</a> </dd></dl>

</div>
</div>
<a id="gae230fdb63b747108d20b95d064b717cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae230fdb63b747108d20b95d064b717cd">&#9670;&nbsp;</a></span>wc_PKCS12_PBKDF()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_PKCS12_PBKDF </td>
          <td>(</td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>passwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kLen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>typeH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>purpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function implements the Password Based Key Derivation Function (PBKDF) described in RFC 7292 Appendix B. This function converts an input password with a concatenated salt into a more secure key, which it stores in output. It allows the user to select any of the supported HMAC hash functions, including: MD5, SHA, SHA256, SHA384, SHA512, and BLAKE2B. </p>
<dl class="section return"><dt>Returns</dt><dd>0 Returned on successfully deriving a key from the input password </dd>
<dd>
BAD_FUNC_ARG Returned if there is an invalid hash type given, iterations is less than 1, or the key length (kLen) requested is greater than the hash length of the provided hash </dd>
<dd>
MEMORY_E Returned if there is an allocating memory </dd>
<dd>
MP_INIT_E may be returned if there is an error during key generation </dd>
<dd>
MP_READ_E may be returned if there is an error during key generation </dd>
<dd>
MP_CMP_E may be returned if there is an error during key generation </dd>
<dd>
MP_INVMOD_E may be returned if there is an error during key generation </dd>
<dd>
MP_EXPTMOD_E may be returned if there is an error during key generation </dd>
<dd>
MP_MOD_E may be returned if there is an error during key generation </dd>
<dd>
MP_MUL_E may be returned if there is an error during key generation </dd>
<dd>
MP_ADD_E may be returned if there is an error during key generation </dd>
<dd>
MP_MULMOD_E may be returned if there is an error during key generation </dd>
<dd>
MP_TO_E may be returned if there is an error during key generation </dd>
<dd>
MP_MEM may be returned if there is an error during key generation</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">output</td><td>pointer to the buffer in which to store the generated key. Should be kLen long </td></tr>
    <tr><td class="paramname">passwd</td><td>pointer to the buffer containing the password to use for the key derivation </td></tr>
    <tr><td class="paramname">pLen</td><td>length of the password to use for key derivation </td></tr>
    <tr><td class="paramname">salt</td><td>pointer to the buffer containing the salt to use for key derivation </td></tr>
    <tr><td class="paramname">sLen</td><td>length of the salt </td></tr>
    <tr><td class="paramname">iterations</td><td>number of times to process the hash </td></tr>
    <tr><td class="paramname">kLen</td><td>desired length of the derived key </td></tr>
    <tr><td class="paramname">hashType</td><td>the hashing algorithm to use. Valid choices are: MD5, SHA, SHA256, SHA384, SHA512, and BLAKE2B </td></tr>
    <tr><td class="paramname">id</td><td>this is a byte indetifier indicating the purpose of key generation. It is used to diversify the key output, and should be assigned as follows: ID=1: pseudorandom bits are to be used as key material for performing encryption or decryption. ID=2: pseudorandom bits are to be used an IV (Initial Value) for encryption or decryption. ID=3: pseudorandom bits are to be used as an integrity key for MACing.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> ret;</div><div class="line">byte key[64];</div><div class="line">byte pass[] = { <span class="comment">/* initialize with password };</span></div><div class="line"><span class="comment">byte salt[] = { /* initialize with salt };</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">ret = wc_PKCS512_PBKDF(key, pass, sizeof(pass), salt, sizeof(salt), 2048, </span></div><div class="line"><span class="comment">sizeof(key), SHA512, 1);</span></div><div class="line"><span class="comment">if ( ret != 0 ) {</span></div><div class="line"><span class="comment">    // error deriving key from password</span></div><div class="line"><span class="comment">}</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_PBKDF1 </dd>
<dd>
<a class="el" href="group__Password.html#ga744b805fda60c99a590ce7d6896e836a" title="This function implements the Password Based Key Derivation Function 2 (PBKDF2), converting an input p...">wc_PBKDF2</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
