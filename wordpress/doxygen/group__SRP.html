<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Algorithms - SRP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Algorithms - SRP</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1ca330be61e9da0056c797517c79b146"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146">wc_SrpInit</a> (<a class="el" href="structSrp.html">Srp</a> *srp, SrpType type, SrpSide side)</td></tr>
<tr class="memdesc:ga1ca330be61e9da0056c797517c79b146"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the <a class="el" href="structSrp.html">Srp</a> struct for usage.  <a href="#ga1ca330be61e9da0056c797517c79b146">More...</a><br /></td></tr>
<tr class="separator:ga1ca330be61e9da0056c797517c79b146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga036febdb641109968e63a786bf10f6d1"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1">wc_SrpTerm</a> (<a class="el" href="structSrp.html">Srp</a> *srp)</td></tr>
<tr class="memdesc:ga036febdb641109968e63a786bf10f6d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the <a class="el" href="structSrp.html">Srp</a> struct resources after usage.  <a href="#ga036febdb641109968e63a786bf10f6d1">More...</a><br /></td></tr>
<tr class="separator:ga036febdb641109968e63a786bf10f6d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9456bdd1a2f2a0dbcc4268de2ca5f6c"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gac9456bdd1a2f2a0dbcc4268de2ca5f6c">wc_SrpSetUsername</a> (<a class="el" href="structSrp.html">Srp</a> *srp, const byte *username, word32 size)</td></tr>
<tr class="memdesc:gac9456bdd1a2f2a0dbcc4268de2ca5f6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the username. This function MUST be called after wc_SrpInit.  <a href="#gac9456bdd1a2f2a0dbcc4268de2ca5f6c">More...</a><br /></td></tr>
<tr class="separator:gac9456bdd1a2f2a0dbcc4268de2ca5f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0f583e98153ee03b8aef88111c74905"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gae0f583e98153ee03b8aef88111c74905">wc_SrpSetParams</a> (<a class="el" href="structSrp.html">Srp</a> *srp, const byte *N, word32 nSz, const byte *g, word32 gSz, const byte *salt, word32 saltSz)</td></tr>
<tr class="memdesc:gae0f583e98153ee03b8aef88111c74905"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername.  <a href="#gae0f583e98153ee03b8aef88111c74905">More...</a><br /></td></tr>
<tr class="separator:gae0f583e98153ee03b8aef88111c74905"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab65f9ea3c8668e24abba997fdf7e806"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gaab65f9ea3c8668e24abba997fdf7e806">wc_SrpSetPassword</a> (<a class="el" href="structSrp.html">Srp</a> *srp, const byte *password, word32 size)</td></tr>
<tr class="memdesc:gaab65f9ea3c8668e24abba997fdf7e806"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the password. Setting the password does not persists the clear password data in the srp structure. The client calculates x = H(salt + H(user:pswd)) and stores it in the auth field. This function MUST be called after wc_SrpSetParams and is CLIENT SIDE ONLY.  <a href="#gaab65f9ea3c8668e24abba997fdf7e806">More...</a><br /></td></tr>
<tr class="separator:gaab65f9ea3c8668e24abba997fdf7e806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac29382f4e3e608dcce29af2be9626416"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gac29382f4e3e608dcce29af2be9626416">wc_SrpSetVerifier</a> (<a class="el" href="structSrp.html">Srp</a> *srp, const byte *verifier, word32 size)</td></tr>
<tr class="memdesc:gac29382f4e3e608dcce29af2be9626416"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY.  <a href="#gac29382f4e3e608dcce29af2be9626416">More...</a><br /></td></tr>
<tr class="separator:gac29382f4e3e608dcce29af2be9626416"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga44e88e5795b4dafc8736ded2189ec117"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#ga44e88e5795b4dafc8736ded2189ec117">wc_SrpGetVerifier</a> (<a class="el" href="structSrp.html">Srp</a> *srp, byte *verifier, word32 *size)</td></tr>
<tr class="memdesc:ga44e88e5795b4dafc8736ded2189ec117"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called after wc_SrpSetPassword and is CLIENT SIDE ONLY.  <a href="#ga44e88e5795b4dafc8736ded2189ec117">More...</a><br /></td></tr>
<tr class="separator:ga44e88e5795b4dafc8736ded2189ec117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ff3657533ba6499e6d6a69e4e763d0b"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#ga8ff3657533ba6499e6d6a69e4e763d0b">wc_SrpSetPrivate</a> (<a class="el" href="structSrp.html">Srp</a> *srp, const byte *priv, word32 size)</td></tr>
<tr class="memdesc:ga8ff3657533ba6499e6d6a69e4e763d0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the private ephemeral value. The private ephemeral value is known as: a at the client side. a = random() b at the server side. b = random() This function is handy for unit test cases or if the developer wants to use an external random source to set the ephemeral value. This function MAY be called before wc_SrpGetPublic.  <a href="#ga8ff3657533ba6499e6d6a69e4e763d0b">More...</a><br /></td></tr>
<tr class="separator:ga8ff3657533ba6499e6d6a69e4e763d0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga687873ae2df9ec25a39b204152d99749"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#ga687873ae2df9ec25a39b204152d99749">wc_SrpGetPublic</a> (<a class="el" href="structSrp.html">Srp</a> *srp, byte *pub, word32 *size)</td></tr>
<tr class="memdesc:ga687873ae2df9ec25a39b204152d99749"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the public ephemeral value. The public ephemeral value is known as: A at the client side. A = g ^ a % N B at the server side. B = (k * v + (g ˆ b % N)) % N This function MUST be called after wc_SrpSetPassword or wc_SrpSetVerifier. The function wc_SrpSetPrivate may be called before wc_SrpGetPublic.  <a href="#ga687873ae2df9ec25a39b204152d99749">More...</a><br /></td></tr>
<tr class="separator:ga687873ae2df9ec25a39b204152d99749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacef2fccc73f1cc25768bc295e058cbe4"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gacef2fccc73f1cc25768bc295e058cbe4">wc_SrpComputeKey</a> (<a class="el" href="structSrp.html">Srp</a> *srp, byte *clientPubKey, word32 clientPubKeySz, byte *serverPubKey, word32 serverPubKeySz)</td></tr>
<tr class="memdesc:gacef2fccc73f1cc25768bc295e058cbe4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the session key. The key can be accessed at srp-&gt;key after success.  <a href="#gacef2fccc73f1cc25768bc295e058cbe4">More...</a><br /></td></tr>
<tr class="separator:gacef2fccc73f1cc25768bc295e058cbe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd9db574d6b02ffc8b8b8257b72b0bec"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gadd9db574d6b02ffc8b8b8257b72b0bec">wc_SrpGetProof</a> (<a class="el" href="structSrp.html">Srp</a> *srp, byte *proof, word32 *size)</td></tr>
<tr class="memdesc:gadd9db574d6b02ffc8b8b8257b72b0bec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the proof. This function MUST be called after wc_SrpComputeKey.  <a href="#gadd9db574d6b02ffc8b8b8257b72b0bec">More...</a><br /></td></tr>
<tr class="separator:gadd9db574d6b02ffc8b8b8257b72b0bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab525fa5e8ed928050261043f3d6b0583"><td class="memItemLeft" align="right" valign="top">WOLFSSL_API int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__SRP.html#gab525fa5e8ed928050261043f3d6b0583">wc_SrpVerifyPeersProof</a> (<a class="el" href="structSrp.html">Srp</a> *srp, byte *proof, word32 size)</td></tr>
<tr class="memdesc:gab525fa5e8ed928050261043f3d6b0583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the peers proof. This function MUST be called before wc_SrpGetSessionKey.  <a href="#gab525fa5e8ed928050261043f3d6b0583">More...</a><br /></td></tr>
<tr class="separator:gab525fa5e8ed928050261043f3d6b0583"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a id="gacef2fccc73f1cc25768bc295e058cbe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacef2fccc73f1cc25768bc295e058cbe4">&#9670;&nbsp;</a></span>wc_SrpComputeKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpComputeKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>clientPubKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>clientPubKeySz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>serverPubKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>serverPubKeySz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the session key. The key can be accessed at srp-&gt;key after success. </p>
<p>Computes the session key.</p>
<p>The key can be accessed at srp-&gt;key after success.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clientPubKey</td><td>the client's public ephemeral value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">clientPubKeySz</td><td>the client's public ephemeral value size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serverPubKey</td><td>the server's public ephemeral value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serverPubKeySz</td><td>the server's public ephemeral value size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, clientPubKey, or serverPubKey or if clientPubKeySz or serverPubKeySz is 0. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpComputeKey is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">clientPubKey</td><td>the client's public ephemeral value. </td></tr>
    <tr><td class="paramname">clientPubKeySz</td><td>the client's public ephemeral value size. </td></tr>
    <tr><td class="paramname">serverPubKey</td><td>the server's public ephemeral value. </td></tr>
    <tr><td class="paramname">serverPubKeySz</td><td>the server's public ephemeral value size.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> <a class="code" href="namespaceserver.html">server</a>;</div><div class="line"></div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">    word32 usernameSize = 4;</div><div class="line">byte password[] = <span class="stringliteral">&quot;password&quot;</span>;</div><div class="line">word32 passwordSize = 8;</div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment">byte verifier[] = { /* Contents of some verifier };</span></div><div class="line"><span class="comment">byte serverPubKey[] = { /* Contents of server pub key };</span></div><div class="line"><span class="comment">word32 serverPubKeySize = sizeof(serverPubKey);</span></div><div class="line"><span class="comment">byte clientPubKey[64];</span></div><div class="line"><span class="comment">word32 clientPubKeySize = 64;</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpInit(&amp;server, SRP_TYPE_SHA, SRP_SERVER_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;server, username, usernameSize);</span></div><div class="line"><span class="comment">wc_SrpSetParams(&amp;server, N, sizeof(N), g, sizeof(g), salt, sizeof(salt));</span></div><div class="line"><span class="comment">wc_SrpSetVerifier(&amp;server, verifier, sizeof(verifier));</span></div><div class="line"><span class="comment">wc_SrpGetPublic(&amp;server, serverPubKey, &amp;serverPubKeySize);</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpComputeKey(&amp;server, clientPubKey, clientPubKeySz,</span></div><div class="line"><span class="comment">                                      serverPubKey, serverPubKeySize)</span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;server);</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga687873ae2df9ec25a39b204152d99749" title="Gets the public ephemeral value. The public ephemeral value is known as: A at the client side...">wc_SrpGetPublic</a> </dd></dl>

</div>
</div>
<a id="gadd9db574d6b02ffc8b8b8257b72b0bec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadd9db574d6b02ffc8b8b8257b72b0bec">&#9670;&nbsp;</a></span>wc_SrpGetProof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpGetProof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>proof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the proof. This function MUST be called after wc_SrpComputeKey. </p>
<p>Gets the proof.</p>
<p>This function MUST be called after wc_SrpComputeKey.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">proof</td><td>the buffer to write the proof. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size</td><td>the buffer size in bytes. Will be updated with the proof size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returns if srp, proof, or size is null. </dd>
<dd>
BUFFER_E Returns if size is less than the hash size of srp-&gt;type. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">proof</td><td>the peers proof. </td></tr>
    <tr><td class="paramname">size</td><td>the proof size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> cli;</div><div class="line">byte clientProof[SRP_MAX_DIGEST_SIZE];</div><div class="line">word32 clientProofSz = SRP_MAX_DIGEST_SIZE;</div><div class="line"></div><div class="line"><span class="comment">// Initialize Srp following steps from previous examples</span></div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__SRP.html#gadd9db574d6b02ffc8b8b8257b72b0bec">wc_SrpGetProof</a>(&amp;cli, clientProof, &amp;clientProofSz) != 0)</div><div class="line">{</div><div class="line">    <span class="comment">// Error getting proof</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#gacef2fccc73f1cc25768bc295e058cbe4" title="Computes the session key. The key can be accessed at srp-&gt;key after success. ">wc_SrpComputeKey</a> </dd></dl>

</div>
</div>
<a id="ga687873ae2df9ec25a39b204152d99749"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga687873ae2df9ec25a39b204152d99749">&#9670;&nbsp;</a></span>wc_SrpGetPublic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpGetPublic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>pub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the public ephemeral value. The public ephemeral value is known as: A at the client side. A = g ^ a % N B at the server side. B = (k * v + (g ˆ b % N)) % N This function MUST be called after wc_SrpSetPassword or wc_SrpSetVerifier. The function wc_SrpSetPrivate may be called before wc_SrpGetPublic. </p>
<p>Gets the public ephemeral value.</p>
<p>The public ephemeral value is known as: A at the client side. A = g ^ a % N B at the server side. B = (k * v + (g ˆ b % N)) % N This function MUST be called after wc_SrpSetPassword or wc_SrpSetVerifier.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pub</td><td>the buffer to write the public ephemeral value. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size</td><td>the the buffer size in bytes. Will be updated with the ephemeral value size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, pub, or size is null. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpGetPublic is called out of order. </dd>
<dd>
BUFFER_E Returned if size &lt; srp.N. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">pub</td><td>the buffer to write the public ephemeral value. </td></tr>
    <tr><td class="paramname">size</td><td>the the buffer size in bytes. Will be updated with the ephemeral value size.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line">byte password[] = <span class="stringliteral">&quot;password&quot;</span>;</div><div class="line">word32 passwordSize = 8;</div><div class="line"></div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment">wc_SrpInit(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;srp, username, usernameSize);</span></div><div class="line"><span class="comment">wc_SrpSetParams(&amp;srp, N, sizeof(N), g, sizeof(g), salt, sizeof(salt));</span></div><div class="line"><span class="comment">wc_SrpSetPassword(&amp;srp, password, passwordSize)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">byte public[64];</span></div><div class="line"><span class="comment">word32 publicSz = 0;</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">if( wc_SrpGetPublic(&amp;srp, public, &amp;publicSz) != 0)</span></div><div class="line"><span class="comment">{</span></div><div class="line"><span class="comment">    // Error getting public ephemeral</span></div><div class="line"><span class="comment">}</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;srp);</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga8ff3657533ba6499e6d6a69e4e763d0b" title="Sets the private ephemeral value. The private ephemeral value is known as: a at the client side...">wc_SrpSetPrivate</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gaab65f9ea3c8668e24abba997fdf7e806" title="Sets the password. Setting the password does not persists the clear password data in the srp structur...">wc_SrpSetPassword</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gac29382f4e3e608dcce29af2be9626416" title="Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY...">wc_SrpSetVerifier</a> </dd></dl>

</div>
</div>
<a id="ga44e88e5795b4dafc8736ded2189ec117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga44e88e5795b4dafc8736ded2189ec117">&#9670;&nbsp;</a></span>wc_SrpGetVerifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpGetVerifier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>verifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32 *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called after wc_SrpSetPassword and is CLIENT SIDE ONLY. </p>
<p>Gets the verifier.</p>
<p>The client calculates the verifier with v = g ^ x % N. This function MAY be called after wc_SrpSetPassword and is CLIENT SIDE ONLY.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">verifier</td><td>the buffer to write the verifier. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">size</td><td>the buffer size in bytes. Will be updated with the verifier size.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, verifier or size is null or if srp-&gt;side is not SRP_CLIENT_SIDE. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpGetVerifier is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>The <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">verifier</td><td>The buffer to write the verifier. </td></tr>
    <tr><td class="paramname">size</td><td>Buffer size in bytes. Updated with the verifier size.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line">byte password[] = <span class="stringliteral">&quot;password&quot;</span>;</div><div class="line">word32 passwordSize = 8;</div><div class="line"></div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment">byte v[64];</span></div><div class="line"><span class="comment">word32 vSz = 0;</span></div><div class="line"><span class="comment">vSz = sizeof(v);</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpInit(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;srp, username, usernameSize);</span></div><div class="line"><span class="comment">wc_SrpSetParams(&amp;srp, N, sizeof(N), g, sizeof(g), salt, sizeof(salt))</span></div><div class="line"><span class="comment">wc_SrpSetPassword(&amp;srp, password, passwordSize)</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">if( wc_SrpGetVerifier(&amp;srp, v, &amp;vSz ) != 0)</span></div><div class="line"><span class="comment">{</span></div><div class="line"><span class="comment">    // Error getting verifier</span></div><div class="line"><span class="comment">}</span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;srp);</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#gac29382f4e3e608dcce29af2be9626416" title="Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY...">wc_SrpSetVerifier</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gaab65f9ea3c8668e24abba997fdf7e806" title="Sets the password. Setting the password does not persists the clear password data in the srp structur...">wc_SrpSetPassword</a> </dd></dl>

</div>
</div>
<a id="ga1ca330be61e9da0056c797517c79b146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1ca330be61e9da0056c797517c79b146">&#9670;&nbsp;</a></span>wc_SrpInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SrpType&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SrpSide&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the <a class="el" href="structSrp.html">Srp</a> struct for usage. </p>
<p>Initializes the <a class="el" href="structSrp.html">Srp</a> struct for usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure to be initialized. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>the hash type to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>the side of the communication.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. </dd>
<dd>
BAD_FUNC_ARG Returns when there's an issue with the arguments such as srp being null or SrpSide not being SRP_CLIENT_SIDE or SRP_SERVER_SIDE. </dd>
<dd>
NOT_COMPILED_IN Returns when a type is passed as an argument but hasn't been configured in the wolfCrypt build. </dd>
<dd>
&lt;0 on error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure to be initialized. </td></tr>
    <tr><td class="paramname">type</td><td>the hash type to be used. </td></tr>
    <tr><td class="paramname">side</td><td>the side of the communication.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE) != 0)</div><div class="line">{</div><div class="line">    <span class="comment">// Initialization error</span></div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">    <a class="code" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1">wc_SrpTerm</a>(&amp;srp);</div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1" title="Releases the Srp struct resources after usage. ">wc_SrpTerm</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gac9456bdd1a2f2a0dbcc4268de2ca5f6c" title="Sets the username. This function MUST be called after wc_SrpInit. ">wc_SrpSetUsername</a> </dd></dl>

</div>
</div>
<a id="gae0f583e98153ee03b8aef88111c74905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0f583e98153ee03b8aef88111c74905">&#9670;&nbsp;</a></span>wc_SrpSetParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpSetParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>nSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>gSz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>salt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>saltSz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername. </p>
<p>Sets the srp parameters based on the username.</p>
<p>This function MUST be called after wc_SrpSetUsername.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>the Modulus. N = 2q+1, [q, N] are primes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nSz</td><td>the N size in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">g</td><td>the Generator modulo N. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gSz</td><td>the g size in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">salt</td><td>a small random salt. Specific for each username. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">saltSz</td><td>the salt size in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<pre class="fragment">\return 0 Success
\return BAD_FUNC_ARG Returns if srp, N, g, or salt is null or if nSz &lt; gSz.
\return SRP_CALL_ORDER_E Returns if wc_SrpSetParams is called before 
</pre><p> wc_SrpSetUsername. </p><dl class="section return"><dt>Returns</dt><dd>&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">N</td><td>the Modulus. N = 2q+1, [q, N] are primes. </td></tr>
    <tr><td class="paramname">nSz</td><td>the N size in bytes. </td></tr>
    <tr><td class="paramname">g</td><td>the Generator modulo N. </td></tr>
    <tr><td class="paramname">gSz</td><td>the g size in bytes </td></tr>
    <tr><td class="paramname">salt</td><td>a small random salt. Specific for each username. </td></tr>
    <tr><td class="paramname">saltSz</td><td>the salt size in bytes <pre class="fragment">_Example_
</pre> <div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line"></div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpInit(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;srp, username, usernameSize);</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">if(wc_SrpSetParams(&amp;srp, N, sizeof(N), g, sizeof(g), salt, sizeof(salt)) != 0)</span></div><div class="line"><span class="comment">{</span></div><div class="line"><span class="comment">    // Error setting params</span></div><div class="line"><span class="comment">}</span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;srp);</span></div></div><!-- fragment --></td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146" title="Initializes the Srp struct for usage. ">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gac9456bdd1a2f2a0dbcc4268de2ca5f6c" title="Sets the username. This function MUST be called after wc_SrpInit. ">wc_SrpSetUsername</a> </dd>
<dd>
<a class="el" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1" title="Releases the Srp struct resources after usage. ">wc_SrpTerm</a> </dd></dl>

</div>
</div>
<a id="gaab65f9ea3c8668e24abba997fdf7e806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab65f9ea3c8668e24abba997fdf7e806">&#9670;&nbsp;</a></span>wc_SrpSetPassword()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpSetPassword </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the password. Setting the password does not persists the clear password data in the srp structure. The client calculates x = H(salt + H(user:pswd)) and stores it in the auth field. This function MUST be called after wc_SrpSetParams and is CLIENT SIDE ONLY. </p>
<p>Sets the password.</p>
<p>Setting the password does not persists the clear password data in the srp structure. The client calculates x = H(salt + H(user:pswd)) and stores it in the auth field.</p>
<p>This function MUST be called after wc_SrpSetParams and is CLIENT SIDE ONLY.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>the buffer containing the password. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the password size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returns if srp or password is null or if srp-&gt;side is not set to SRP_CLIENT_SIDE. </dd>
<dd>
SRP_CALL_ORDER_E Returns when wc_SrpSetPassword is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>The <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">password</td><td>The buffer containing the password. </td></tr>
    <tr><td class="paramname">size</td><td>The size of the password in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line">byte password[] = <span class="stringliteral">&quot;password&quot;</span>;</div><div class="line">word32 passwordSize = 8;</div><div class="line"></div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpInit(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;srp, username, usernameSize);</span></div><div class="line"><span class="comment">wc_SrpSetParams(&amp;srp, N, sizeof(N), g, sizeof(g), salt, sizeof(salt));</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">if(wc_SrpSetPassword(&amp;srp, password, passwordSize) != 0)</span></div><div class="line"><span class="comment">{</span></div><div class="line"><span class="comment">    // Error setting password</span></div><div class="line"><span class="comment">}</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;srp);</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146" title="Initializes the Srp struct for usage. ">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gac9456bdd1a2f2a0dbcc4268de2ca5f6c" title="Sets the username. This function MUST be called after wc_SrpInit. ">wc_SrpSetUsername</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gae0f583e98153ee03b8aef88111c74905" title="Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername. ">wc_SrpSetParams</a> </dd></dl>

</div>
</div>
<a id="ga8ff3657533ba6499e6d6a69e4e763d0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ff3657533ba6499e6d6a69e4e763d0b">&#9670;&nbsp;</a></span>wc_SrpSetPrivate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpSetPrivate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>priv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the private ephemeral value. The private ephemeral value is known as: a at the client side. a = random() b at the server side. b = random() This function is handy for unit test cases or if the developer wants to use an external random source to set the ephemeral value. This function MAY be called before wc_SrpGetPublic. </p>
<p>Sets the private ephemeral value.</p>
<p>The private ephemeral value is known as: a at the client side. a = random() b at the server side. b = random() This function is handy for unit test cases or if the developer wants to use an external random source to set the ephemeral value. This function MAY be called before wc_SrpGetPublic.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">priv</td><td>the ephemeral value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the private size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp, private, or size is null. </dd>
<dd>
SRP_CALL_ORDER_E Returned if wc_SrpSetPrivate is called out of order. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">priv</td><td>the ephemeral value. </td></tr>
    <tr><td class="paramname">size</td><td>the private size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line"></div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment">byte verifier = { /* Contents of some verifier };</span></div><div class="line"><span class="comment">wc_SrpInit(&amp;srp, SRP_TYPE_SHA, SRP_SERVER_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;srp, username, usernameSize);</span></div><div class="line"><span class="comment">wc_SrpSetParams(&amp;srp, N, sizeof(N), g, sizeof(g), salt, sizeof(salt))</span></div><div class="line"><span class="comment">wc_SrpSetVerifier(&amp;srp, verifier, sizeof(verifier))</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">byte b[] = { /* Some ephemeral value }</span></div><div class="line"><span class="comment">if( wc_SrpSetPrivate(&amp;srp, b, sizeof(b)) != 0)</span></div><div class="line"><span class="comment">{</span></div><div class="line"><span class="comment">    // Error setting private ephemeral</span></div><div class="line"><span class="comment">}</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;srp);</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga687873ae2df9ec25a39b204152d99749" title="Gets the public ephemeral value. The public ephemeral value is known as: A at the client side...">wc_SrpGetPublic</a> </dd></dl>

</div>
</div>
<a id="gac9456bdd1a2f2a0dbcc4268de2ca5f6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9456bdd1a2f2a0dbcc4268de2ca5f6c">&#9670;&nbsp;</a></span>wc_SrpSetUsername()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpSetUsername </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the username. This function MUST be called after wc_SrpInit. </p>
<p>Sets the username.</p>
<p>This function MUST be called after wc_SrpInit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>the buffer containing the username. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the username size in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Username set successfully. </dd>
<dd>
BAD_FUNC_ARG: Return if srp or username is null. </dd>
<dd>
MEMORY_E: Returns if there is an issue allocating memory for srp-&gt;user </dd>
<dd>
&lt; 0: Error.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">username</td><td>the buffer containing the username. </td></tr>
    <tr><td class="paramname">size</td><td>the username size in bytes</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line"></div><div class="line"><a class="code" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div><div class="line"><span class="keywordflow">if</span>(<a class="code" href="group__SRP.html#gac9456bdd1a2f2a0dbcc4268de2ca5f6c">wc_SrpSetUsername</a>(&amp;srp, username, usernameSize) != 0)</div><div class="line">{</div><div class="line">    <span class="comment">// Error occurred setting username.</span></div><div class="line">}</div><div class="line"><a class="code" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1">wc_SrpTerm</a>(&amp;srp);</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146" title="Initializes the Srp struct for usage. ">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gae0f583e98153ee03b8aef88111c74905" title="Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername. ">wc_SrpSetParams</a> </dd>
<dd>
<a class="el" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1" title="Releases the Srp struct resources after usage. ">wc_SrpTerm</a> </dd></dl>

</div>
</div>
<a id="gac29382f4e3e608dcce29af2be9626416"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac29382f4e3e608dcce29af2be9626416">&#9670;&nbsp;</a></span>wc_SrpSetVerifier()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpSetVerifier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const byte *&#160;</td>
          <td class="paramname"><em>verifier</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the verifier. This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY. </p>
<p>Sets the verifier.</p>
<p>This function MUST be called after wc_SrpSetParams and is SERVER SIDE ONLY.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verifier</td><td>the buffer containing the verifier. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the verifier size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
BAD_FUNC_ARG Returned if srp or verifier is null or srp-&gt;side is not SRP_SERVER_SIDE. </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>The <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">verifier</td><td>The structure containing the verifier. </td></tr>
    <tr><td class="paramname">size</td><td>The verifier size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line">byte username[] = <span class="stringliteral">&quot;user&quot;</span>;</div><div class="line">word32 usernameSize = 4;</div><div class="line"></div><div class="line">byte N[] = { <span class="comment">/* Contents of byte array N };</span></div><div class="line"><span class="comment">byte g[] = { /* Contents of byte array g };</span></div><div class="line"><span class="comment">byte salt[] = { /* Contents of byte array salt };</span></div><div class="line"><span class="comment">wc_SrpInit(&amp;srp, SRP_TYPE_SHA, SRP_SERVER_SIDE);</span></div><div class="line"><span class="comment">wc_SrpSetUsername(&amp;srp, username, usernameSize);</span></div><div class="line"><span class="comment">wc_SrpSetParams(&amp;srp, N, sizeof(N), g, sizeof(g), salt, sizeof(salt))</span></div><div class="line"><span class="comment">byte verifier[] = { /* Contents of some verifier };</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">if(wc_SrpSetVerifier(&amp;srp, verifier, sizeof(verifier)) != 0)</span></div><div class="line"><span class="comment">{</span></div><div class="line"><span class="comment">    // Error setting verifier</span></div><div class="line"><span class="comment">}</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">wc_SrpTerm(&amp;srp);</span></div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146" title="Initializes the Srp struct for usage. ">wc_SrpInit</a> </dd>
<dd>
<a class="el" href="group__SRP.html#gae0f583e98153ee03b8aef88111c74905" title="Sets the srp parameters based on the username.. Must be called after wc_SrpSetUsername. ">wc_SrpSetParams</a> </dd>
<dd>
<a class="el" href="group__SRP.html#ga44e88e5795b4dafc8736ded2189ec117" title="Gets the verifier. The client calculates the verifier with v = g ^ x % N. This function MAY be called...">wc_SrpGetVerifier</a> </dd></dl>

</div>
</div>
<a id="ga036febdb641109968e63a786bf10f6d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga036febdb641109968e63a786bf10f6d1">&#9670;&nbsp;</a></span>wc_SrpTerm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API void wc_SrpTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the <a class="el" href="structSrp.html">Srp</a> struct resources after usage. </p>
<p>Releases the <a class="el" href="structSrp.html">Srp</a> struct resources after usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure to be terminated.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none No returns.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>Pointer to the <a class="el" href="structSrp.html">Srp</a> structure to be terminated.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> srp;</div><div class="line"><a class="code" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146">wc_SrpInit</a>(&amp;srp, SRP_TYPE_SHA, SRP_CLIENT_SIDE);</div><div class="line"><span class="comment">// Use srp</span></div><div class="line"><a class="code" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1">wc_SrpTerm</a>(&amp;srp)</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__SRP.html#ga1ca330be61e9da0056c797517c79b146" title="Initializes the Srp struct for usage. ">wc_SrpInit</a> </dd></dl>

</div>
</div>
<a id="gab525fa5e8ed928050261043f3d6b0583"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab525fa5e8ed928050261043f3d6b0583">&#9670;&nbsp;</a></span>wc_SrpVerifyPeersProof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">WOLFSSL_API int wc_SrpVerifyPeersProof </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSrp.html">Srp</a> *&#160;</td>
          <td class="paramname"><em>srp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte *&#160;</td>
          <td class="paramname"><em>proof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">word32&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Verifies the peers proof. This function MUST be called before wc_SrpGetSessionKey. </p>
<p>Verifies the peers proof.</p>
<p>This function MUST be called before wc_SrpGetSessionKey.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">proof</td><td>the peers proof. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>the proof size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, { &lt;} 0 on error. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>error-crypt.h</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>0 Success </dd>
<dd>
&lt;0 Error</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srp</td><td>the <a class="el" href="structSrp.html">Srp</a> structure. </td></tr>
    <tr><td class="paramname">proof</td><td>the peers proof. </td></tr>
    <tr><td class="paramname">size</td><td>the proof size in bytes.</td></tr>
  </table>
  </dd>
</dl>
<p><em>Example</em> </p><div class="fragment"><div class="line"><a class="code" href="structSrp.html">Srp</a> cli;</div><div class="line"><a class="code" href="structSrp.html">Srp</a> srv;</div><div class="line">byte clientProof[SRP_MAX_DIGEST_SIZE];</div><div class="line">word32 clientProofSz = SRP_MAX_DIGEST_SIZE;</div><div class="line"></div><div class="line"><span class="comment">// Initialize Srp following steps from previous examples</span></div><div class="line"><span class="comment">// First get the proof</span></div><div class="line"><a class="code" href="group__SRP.html#gadd9db574d6b02ffc8b8b8257b72b0bec">wc_SrpGetProof</a>(&amp;cli, clientProof, &amp;clientProofSz)</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__SRP.html#gab525fa5e8ed928050261043f3d6b0583">wc_SrpVerifyPeersProof</a>(&amp;srv, clientProof, clientProofSz) != 0)</div><div class="line">{</div><div class="line">    <span class="comment">// Error verifying proof</span></div><div class="line">}</div></div><!-- fragment --><dl class="section see"><dt>See also</dt><dd>wc_SrpGetSessionKey </dd>
<dd>
<a class="el" href="group__SRP.html#gadd9db574d6b02ffc8b8b8257b72b0bec" title="Gets the proof. This function MUST be called after wc_SrpComputeKey. ">wc_SrpGetProof</a> </dd>
<dd>
<a class="el" href="group__SRP.html#ga036febdb641109968e63a786bf10f6d1" title="Releases the Srp struct resources after usage. ">wc_SrpTerm</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
