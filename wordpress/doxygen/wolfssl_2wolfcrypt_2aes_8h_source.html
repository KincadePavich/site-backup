<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>/home/conner/Desktop/WolfSSL_Docs/doxygen/dox_repo/wolfssl/wolfssl/wolfcrypt/aes.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dfb12bfb545c81f98c26cc500f1dbda8.html">wolfssl</a></li><li class="navelem"><a class="el" href="dir_82794da501e4dededf736909a151513c.html">wolfssl</a></li><li class="navelem"><a class="el" href="dir_bc71be20e808467ceb976987b7b00b8f.html">wolfcrypt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">aes.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/* aes.h</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright (C) 2006-2016 wolfSSL Inc.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * This file is part of wolfSSL.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * wolfSSL is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * (at your option) any later version.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * wolfSSL is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1335, USA</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef WOLF_CRYPT_AES_H</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#define WOLF_CRYPT_AES_H</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;wolfssl/wolfcrypt/types.h&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef NO_AES</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/* included for fips @wc_fips */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef HAVE_FIPS</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;cyassl/ctaocrypt/aes.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#if defined(CYASSL_AES_COUNTER) &amp;&amp; !defined(WOLFSSL_AES_COUNTER)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">    #define WOLFSSL_AES_COUNTER</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#if !defined(WOLFSSL_AES_DIRECT) &amp;&amp; defined(CYASSL_AES_DIRECT)</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">    #define WOLFSSL_AES_DIRECT</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#ifndef HAVE_FIPS </span><span class="comment">/* to avoid redefinition of macros */</span><span class="preprocessor"></span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_AESNI</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;wmmintrin.h&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;emmintrin.h&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;smmintrin.h&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* WOLFSSL_AESNI */</span><span class="preprocessor"></span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_FIPS */</span><span class="preprocessor"></span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#ifndef HAVE_FIPS </span><span class="comment">/* to avoid redefinition of structures */</span><span class="preprocessor"></span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_ASYNC_CRYPT</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">    #include &lt;wolfssl/wolfcrypt/async.h&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">enum</span> {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    AES_ENC_TYPE   = 1,   <span class="comment">/* cipher unique type */</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    AES_ENCRYPTION = 0,</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    AES_DECRYPTION = 1,</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    KEYWRAP_BLOCK_SIZE = 8,</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    AES_BLOCK_SIZE = 16</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;};</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structAes.html">   71</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAes.html">Aes</a> {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">/* AESNI needs key first, rounds 2nd, not sure why yet */</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    ALIGN16 word32 key[60];</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    word32  rounds;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">int</span>     keylen;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    ALIGN16 word32 reg[AES_BLOCK_SIZE / <span class="keyword">sizeof</span>(word32)];      <span class="comment">/* for CBC mode */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    ALIGN16 word32 tmp[AES_BLOCK_SIZE / <span class="keyword">sizeof</span>(word32)];      <span class="comment">/* same         */</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#ifdef HAVE_AESGCM</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    ALIGN16 byte H[AES_BLOCK_SIZE];</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#ifdef GCM_TABLE</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">/* key-based fast multiplication table. */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    ALIGN16 byte M0[256][AES_BLOCK_SIZE];</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* GCM_TABLE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_AESGCM */</span><span class="preprocessor"></span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_AESNI</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    byte use_aesni;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* WOLFSSL_AESNI */</span><span class="preprocessor"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_ASYNC_CRYPT</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    word32 asyncKey[AES_MAX_KEY_SIZE/8/<span class="keyword">sizeof</span>(word32)]; <span class="comment">/* raw key */</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    word32 asyncIv[AES_BLOCK_SIZE/<span class="keyword">sizeof</span>(word32)]; <span class="comment">/* raw IV */</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    WC_ASYNC_DEV asyncDev;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* WOLFSSL_ASYNC_CRYPT */</span><span class="preprocessor"></span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_AES_COUNTER</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    word32  left;            <span class="comment">/* unused bytes left from last call */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_PIC32MZ_CRYPT</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    word32 key_ce[AES_BLOCK_SIZE*2/<span class="keyword">sizeof</span>(word32)] ;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    word32 iv_ce [AES_BLOCK_SIZE  /<span class="keyword">sizeof</span>(word32)] ;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">void</span>*  heap; <span class="comment">/* memory hint to use */</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;} <a class="code" href="structAes.html">Aes</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#ifdef HAVE_AESGCM</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="structGmac.html">  107</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structGmac.html">Gmac</a> {</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="structAes.html">Aes</a> aes;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;} <a class="code" href="structGmac.html">Gmac</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_AESGCM */</span><span class="preprocessor"></span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_FIPS */</span><span class="preprocessor"></span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">/* Authenticate cipher function prototypes */</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">typedef</span> int (*wc_AesAuthEncryptFunc)(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 sz,</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                   <span class="keyword">const</span> byte* iv, word32 ivSz,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                   byte* authTag, word32 authTagSz,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                   <span class="keyword">const</span> byte* authIn, word32 authInSz);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">typedef</span> int (*wc_AesAuthDecryptFunc)(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 sz,</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                   <span class="keyword">const</span> byte* iv, word32 ivSz,</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                   <span class="keyword">const</span> byte* authTag, word32 authTagSz,</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                   <span class="keyword">const</span> byte* authIn, word32 authInSz);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">/* AES-CBC */</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504">wc_AesSetKey</a>(<a class="code" href="structAes.html">Aes</a>* aes, <span class="keyword">const</span> byte* key, word32 len,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                              <span class="keyword">const</span> byte* iv, <span class="keywordtype">int</span> dir);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12">wc_AesSetIV</a>(<a class="code" href="structAes.html">Aes</a>* aes, <span class="keyword">const</span> byte* iv);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga1466f105e2e23ce9d3b044bc20bc07f2">wc_AesCbcEncrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                  <span class="keyword">const</span> byte* in, word32 sz);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga87c89c64e24e60fb1a636bcc6efbae73">wc_AesCbcDecrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                  <span class="keyword">const</span> byte* in, word32 sz);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#ifdef HAVE_AES_ECB</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;WOLFSSL_API <span class="keywordtype">int</span> wc_AesEcbEncrypt(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                  <span class="keyword">const</span> byte* in, word32 sz);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;WOLFSSL_API <span class="keywordtype">int</span> wc_AesEcbDecrypt(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                  <span class="keyword">const</span> byte* in, word32 sz);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">/* AES-CTR */</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#ifdef WOLFSSL_AES_COUNTER</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; WOLFSSL_API <span class="keywordtype">void</span> <a class="code" href="group__AES.html#ga19af25c72f0ff4815ba6978e5e3ed5a1">wc_AesCtrEncrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 sz);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/* AES-DIRECT */</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#if defined(WOLFSSL_AES_DIRECT)</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; WOLFSSL_API <span class="keywordtype">void</span> <a class="code" href="group__AES.html#gad3024b8e0a8c87e4f3eedd8ac30e82df">wc_AesEncryptDirect</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out, <span class="keyword">const</span> byte* in);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; WOLFSSL_API <span class="keywordtype">void</span> <a class="code" href="group__AES.html#gac7bd2aaa18433fa2a72d301818fa84a4">wc_AesDecryptDirect</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out, <span class="keyword">const</span> byte* in);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#gaa8334d68fb641489f93832250fd8772b">wc_AesSetKeyDirect</a>(<a class="code" href="structAes.html">Aes</a>* aes, <span class="keyword">const</span> byte* key, word32 len,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                <span class="keyword">const</span> byte* iv, <span class="keywordtype">int</span> dir);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#ifdef HAVE_AESGCM</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga807d1fb3bb9a2f2e7a1aa269706666cc">wc_AesGcmSetKey</a>(<a class="code" href="structAes.html">Aes</a>* aes, <span class="keyword">const</span> byte* key, word32 len);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga512cda371bd4f72c5ec836ddea29ce7a">wc_AesGcmEncrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 sz,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                   <span class="keyword">const</span> byte* iv, word32 ivSz,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                                   byte* authTag, word32 authTagSz,</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                   <span class="keyword">const</span> byte* authIn, word32 authInSz);</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga278f3e5a4b8b2f341c19a0751ff2de57">wc_AesGcmDecrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 sz,</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                   <span class="keyword">const</span> byte* iv, word32 ivSz,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                   <span class="keyword">const</span> byte* authTag, word32 authTagSz,</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                   <span class="keyword">const</span> byte* authIn, word32 authInSz);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; WOLFSSL_API <span class="keywordtype">int</span> <a class="code" href="group__AES.html#ga656b05eb12dcdd9a864aff030a0f84cb">wc_GmacSetKey</a>(<a class="code" href="structGmac.html">Gmac</a>* gmac, <span class="keyword">const</span> byte* key, word32 len);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; WOLFSSL_API <span class="keywordtype">int</span> <a class="code" href="group__AES.html#gad394ab026b167bbd81c49eb4f75283aa">wc_GmacUpdate</a>(<a class="code" href="structGmac.html">Gmac</a>* gmac, <span class="keyword">const</span> byte* iv, word32 ivSz,</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                               <span class="keyword">const</span> byte* authIn, word32 authInSz,</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                               byte* authTag, word32 authTagSz);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_AESGCM */</span><span class="preprocessor"></span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#ifdef HAVE_AESCCM</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#ga7544488439c4bd369e14e9613f21df9a">wc_AesCcmSetKey</a>(<a class="code" href="structAes.html">Aes</a>* aes, <span class="keyword">const</span> byte* key, word32 keySz);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#gad09e65d89dc98d674ed06222a0e8305a">wc_AesCcmEncrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 inSz,</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                   <span class="keyword">const</span> byte* nonce, word32 nonceSz,</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                   byte* authTag, word32 authTagSz,</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                   <span class="keyword">const</span> byte* authIn, word32 authInSz);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  <a class="code" href="group__AES.html#gabd7b25bd041af0b9e5d4d5ba9512065e">wc_AesCcmDecrypt</a>(<a class="code" href="structAes.html">Aes</a>* aes, byte* out,</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                   <span class="keyword">const</span> byte* in, word32 inSz,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                   <span class="keyword">const</span> byte* nonce, word32 nonceSz,</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                   <span class="keyword">const</span> byte* authTag, word32 authTagSz,</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                   <span class="keyword">const</span> byte* authIn, word32 authInSz);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_AESCCM */</span><span class="preprocessor"></span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">#ifdef HAVE_AES_KEYWRAP</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  wc_AesKeyWrap(<span class="keyword">const</span> byte* key, word32 keySz,</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                <span class="keyword">const</span> byte* in, word32 inSz,</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                byte* out, word32 outSz,</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                <span class="keyword">const</span> byte* iv);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; WOLFSSL_API <span class="keywordtype">int</span>  wc_AesKeyUnWrap(<span class="keyword">const</span> byte* key, word32 keySz,</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                <span class="keyword">const</span> byte* in, word32 inSz,</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                byte* out, word32 outSz,</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                <span class="keyword">const</span> byte* iv);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HAVE_AES_KEYWRAP */</span><span class="preprocessor"></span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;WOLFSSL_API <span class="keywordtype">int</span> wc_AesGetKeySize(<a class="code" href="structAes.html">Aes</a>* aes, word32* keySize);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;WOLFSSL_API <span class="keywordtype">int</span>  wc_AesInit(<a class="code" href="structAes.html">Aes</a>*, <span class="keywordtype">void</span>*, <span class="keywordtype">int</span>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;WOLFSSL_API <span class="keywordtype">void</span> wc_AesFree(<a class="code" href="structAes.html">Aes</a>*);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    } <span class="comment">/* extern &quot;C&quot; */</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* NO_AES */</span><span class="preprocessor"></span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* WOLF_CRYPT_AES_H */</span><span class="preprocessor"></span></div><div class="ttc" id="group__AES_html_gad09e65d89dc98d674ed06222a0e8305a"><div class="ttname"><a href="group__AES.html#gad09e65d89dc98d674ed06222a0e8305a">wc_AesCcmEncrypt</a></div><div class="ttdeci">WOLFSSL_API int wc_AesCcmEncrypt(Aes *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function encrypts the input message, in, into the output buffer, out, using CCM (Counter with CB...</div><div class="ttdef"><b>Definition:</b> aes.c:180</div></div>
<div class="ttc" id="group__AES_html_gaf7bd8d861fbd229429725a918fd85a12"><div class="ttname"><a href="group__AES.html#gaf7bd8d861fbd229429725a918fd85a12">wc_AesSetIV</a></div><div class="ttdeci">WOLFSSL_API int wc_AesSetIV(Aes *aes, const byte *iv)</div><div class="ttdoc">This function sets the initialization vector for a particular AES object. The AES object should be in...</div><div class="ttdef"><b>Definition:</b> aes.c:46</div></div>
<div class="ttc" id="structGmac_html"><div class="ttname"><a href="structGmac.html">Gmac</a></div><div class="ttdef"><b>Definition:</b> aes.h:107</div></div>
<div class="ttc" id="group__AES_html_ga87c89c64e24e60fb1a636bcc6efbae73"><div class="ttname"><a href="group__AES.html#ga87c89c64e24e60fb1a636bcc6efbae73">wc_AesCbcDecrypt</a></div><div class="ttdeci">WOLFSSL_API int wc_AesCbcDecrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">Decrypts a cipher from the input buffer in, and places the resulting plain text in the output buffer ...</div><div class="ttdef"><b>Definition:</b> aes.c:64</div></div>
<div class="ttc" id="group__AES_html_ga7544488439c4bd369e14e9613f21df9a"><div class="ttname"><a href="group__AES.html#ga7544488439c4bd369e14e9613f21df9a">wc_AesCcmSetKey</a></div><div class="ttdeci">WOLFSSL_API int wc_AesCcmSetKey(Aes *aes, const byte *key, word32 keySz)</div><div class="ttdoc">This function sets the key for an AES object using CCM (Counter with CBC-MAC). It takes a pointer to ...</div><div class="ttdef"><b>Definition:</b> aes.c:176</div></div>
<div class="ttc" id="group__AES_html_ga656b05eb12dcdd9a864aff030a0f84cb"><div class="ttname"><a href="group__AES.html#ga656b05eb12dcdd9a864aff030a0f84cb">wc_GmacSetKey</a></div><div class="ttdeci">WOLFSSL_API int wc_GmacSetKey(Gmac *gmac, const byte *key, word32 len)</div><div class="ttdoc">This function initializes and sets the key for a GMAC object to be used for Galois Message Authentica...</div><div class="ttdef"><b>Definition:</b> aes.c:151</div></div>
<div class="ttc" id="structAes_html"><div class="ttname"><a href="structAes.html">Aes</a></div><div class="ttdef"><b>Definition:</b> aes.h:71</div></div>
<div class="ttc" id="group__AES_html_ga19af25c72f0ff4815ba6978e5e3ed5a1"><div class="ttname"><a href="group__AES.html#ga19af25c72f0ff4815ba6978e5e3ed5a1">wc_AesCtrEncrypt</a></div><div class="ttdeci">WOLFSSL_API void wc_AesCtrEncrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">Encrypts/Decrypts a message from the input buffer in, and places the resulting cipher text in the out...</div><div class="ttdef"><b>Definition:</b> aes.c:78</div></div>
<div class="ttc" id="group__AES_html_gaa8334d68fb641489f93832250fd8772b"><div class="ttname"><a href="group__AES.html#gaa8334d68fb641489f93832250fd8772b">wc_AesSetKeyDirect</a></div><div class="ttdeci">WOLFSSL_API int wc_AesSetKeyDirect(Aes *aes, const byte *key, word32 len, const byte *iv, int dir)</div><div class="ttdoc">This function is used to set the AES keys for CTR mode with AES. It initializes an AES object with th...</div><div class="ttdef"><b>Definition:</b> aes.c:102</div></div>
<div class="ttc" id="group__AES_html_gad3024b8e0a8c87e4f3eedd8ac30e82df"><div class="ttname"><a href="group__AES.html#gad3024b8e0a8c87e4f3eedd8ac30e82df">wc_AesEncryptDirect</a></div><div class="ttdeci">WOLFSSL_API void wc_AesEncryptDirect(Aes *aes, byte *out, const byte *in)</div><div class="ttdoc">This function is a one-block encrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled. </div><div class="ttdef"><b>Definition:</b> aes.c:90</div></div>
<div class="ttc" id="group__AES_html_ga1466f105e2e23ce9d3b044bc20bc07f2"><div class="ttname"><a href="group__AES.html#ga1466f105e2e23ce9d3b044bc20bc07f2">wc_AesCbcEncrypt</a></div><div class="ttdeci">WOLFSSL_API int wc_AesCbcEncrypt(Aes *aes, byte *out, const byte *in, word32 sz)</div><div class="ttdoc">Encrypts a plaintext message from the input buffer in, and places the resulting cipher text in the ou...</div><div class="ttdef"><b>Definition:</b> aes.c:55</div></div>
<div class="ttc" id="group__AES_html_gabd7b25bd041af0b9e5d4d5ba9512065e"><div class="ttname"><a href="group__AES.html#gabd7b25bd041af0b9e5d4d5ba9512065e">wc_AesCcmDecrypt</a></div><div class="ttdeci">WOLFSSL_API int wc_AesCcmDecrypt(Aes *aes, byte *out, const byte *in, word32 inSz, const byte *nonce, word32 nonceSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function decrypts the input cipher text, in, into the output buffer, out, using CCM (Counter wit...</div><div class="ttdef"><b>Definition:</b> aes.c:196</div></div>
<div class="ttc" id="group__AES_html_gad394ab026b167bbd81c49eb4f75283aa"><div class="ttname"><a href="group__AES.html#gad394ab026b167bbd81c49eb4f75283aa">wc_GmacUpdate</a></div><div class="ttdeci">WOLFSSL_API int wc_GmacUpdate(Gmac *gmac, const byte *iv, word32 ivSz, const byte *authIn, word32 authInSz, byte *authTag, word32 authTagSz)</div><div class="ttdoc">This function generates the Gmac hash of the authIn input and stores the result in the authTag buffer...</div><div class="ttdef"><b>Definition:</b> aes.c:160</div></div>
<div class="ttc" id="group__AES_html_ga807d1fb3bb9a2f2e7a1aa269706666cc"><div class="ttname"><a href="group__AES.html#ga807d1fb3bb9a2f2e7a1aa269706666cc">wc_AesGcmSetKey</a></div><div class="ttdeci">WOLFSSL_API int wc_AesGcmSetKey(Aes *aes, const byte *key, word32 len)</div><div class="ttdoc">This function is used to set the key for AES GCM (Galois/Counter Mode). It initializes an AES object ...</div><div class="ttdef"><b>Definition:</b> aes.c:111</div></div>
<div class="ttc" id="group__AES_html_gac7bd2aaa18433fa2a72d301818fa84a4"><div class="ttname"><a href="group__AES.html#gac7bd2aaa18433fa2a72d301818fa84a4">wc_AesDecryptDirect</a></div><div class="ttdeci">WOLFSSL_API void wc_AesDecryptDirect(Aes *aes, byte *out, const byte *in)</div><div class="ttdoc">This function is a one-block decrypt of the input block, in, into the output block, out. It uses the key and iv (initialization vector) of the provided AES structure, which should be initialized with wc_AesSetKey before calling this function. It is only enabled if the configure option WOLFSSL_AES_DIRECT is enabled, and there is support for direct AES encryption on the system in question. </div><div class="ttdef"><b>Definition:</b> aes.c:96</div></div>
<div class="ttc" id="group__AES_html_ga712dec743cae54ca3f5d3e67eedaa504"><div class="ttname"><a href="group__AES.html#ga712dec743cae54ca3f5d3e67eedaa504">wc_AesSetKey</a></div><div class="ttdeci">WOLFSSL_API int wc_AesSetKey(Aes *aes, const byte *key, word32 len, const byte *iv, int dir)</div><div class="ttdoc">This function initializes an AES structure by setting the key and then setting the initialization vec...</div><div class="ttdef"><b>Definition:</b> aes.c:37</div></div>
<div class="ttc" id="group__AES_html_ga278f3e5a4b8b2f341c19a0751ff2de57"><div class="ttname"><a href="group__AES.html#ga278f3e5a4b8b2f341c19a0751ff2de57">wc_AesGcmDecrypt</a></div><div class="ttdeci">WOLFSSL_API int wc_AesGcmDecrypt(Aes *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, const byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function decrypts the input cipher text, held in the buffer in, and stores the resulting message...</div><div class="ttdef"><b>Definition:</b> aes.c:135</div></div>
<div class="ttc" id="group__AES_html_ga512cda371bd4f72c5ec836ddea29ce7a"><div class="ttname"><a href="group__AES.html#ga512cda371bd4f72c5ec836ddea29ce7a">wc_AesGcmEncrypt</a></div><div class="ttdeci">WOLFSSL_API int wc_AesGcmEncrypt(Aes *aes, byte *out, const byte *in, word32 sz, const byte *iv, word32 ivSz, byte *authTag, word32 authTagSz, const byte *authIn, word32 authInSz)</div><div class="ttdoc">This function encrypts the input message, held in the buffer in, and stores the resulting cipher text...</div><div class="ttdef"><b>Definition:</b> aes.c:119</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
